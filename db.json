{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/avatar.jpeg","path":"avatar.jpeg","modified":1,"renderable":0},{"_id":"source/favicon.png","path":"favicon.png","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-icon-180x180.png","path":"images/apple-icon-180x180.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16.png","path":"images/favicon-16x16.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32.png","path":"images/favicon-32x32.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"6974ddb0953597b845d10c3aec9016f9ed161fbb","modified":1537887087000},{"_id":"source/avatar.jpeg","hash":"79005cf5724dc4a1e775db01eda46a2c8decf14f","modified":1520401170000},{"_id":"source/favicon.png","hash":"8b6513c2f96de00094a4496111a8998bae91bc94","modified":1520401170000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1520401170000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1520401170000},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1520401170000},{"_id":"themes/next/.gitignore","hash":"0b5c2ffd41f66eb1849d6426ba8cf9649eeed329","modified":1520401170000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1520401170000},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1520401170000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1520401170000},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1520401170000},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1520401170000},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1520401170000},{"_id":"themes/next/README.cn.md","hash":"6d9177e7dad87e6129760e4b559bd3f7a15429d7","modified":1520401170000},{"_id":"themes/next/README.md","hash":"529d53dfa97678f8ce4c95620b26e61154162a29","modified":1520401170000},{"_id":"themes/next/_config.yml","hash":"e6552500a6ee45dca0ce5aa8418195103b7d8dc9","modified":1520401170000},{"_id":"themes/next/bower.json","hash":"6d6ae7531cf3fedc97c58cdad664f5793eb3cc88","modified":1520401170000},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1520401170000},{"_id":"themes/next/package.json","hash":"93a74dbc0fe3a1208a02e9cec3c15c2375339cc1","modified":1520401170000},{"_id":"source/_posts/centos-net.md","hash":"eba42b59a4db9fa9e61084861cc547d637e3c65a","modified":1520401170000},{"_id":"source/_posts/ceph-ansible.md","hash":"ce4f907587941186d7e61463ee25236fa7140e36","modified":1520401170000},{"_id":"source/_posts/git-patch.md","hash":"51f4a81123c4e46655acbd9a024f981b5f46588b","modified":1520492657000},{"_id":"source/_posts/logrotate.md","hash":"56a97fe6051cb00fc2abb17a205c9c28a14cb6bf","modified":1520401170000},{"_id":"source/_posts/mysql-replication.md","hash":"218c33c7f17c15c38e577557b0d5e7acfa7eb0e5","modified":1537933672000},{"_id":"source/_posts/nextcloud-ceph.md","hash":"7ab0aee624b7a59d913237b4ceac365b6ce8e759","modified":1537934293000},{"_id":"source/_posts/pacemaker-mysql.md","hash":"c4c475ffa9a29f56ab5623e12c09490776974186","modified":1537933642000},{"_id":"source/_posts/redis-persistence.md","hash":"c28a1dacb606ed1c463859b1927490ad7049d4f3","modified":1537711964000},{"_id":"source/_posts/reposync.md","hash":"d06b04813be0df05f64289f72280b070cf4974c1","modified":1529740328000},{"_id":"source/_posts/rpm-mock.md","hash":"52fb57aebd272464efd52d49d49555e9fa98387d","modified":1537929862000},{"_id":"source/_posts/s3cmd.md","hash":"149eb0c68224b358990b235f2c858daacfc09c0c","modified":1520401170000},{"_id":"source/_posts/service-too-quickly.md","hash":"c5ab35240185a9236d03d8aadffa9db31b4d79a5","modified":1520401170000},{"_id":"source/_posts/string-join.md","hash":"927d45f9d19f2ee10f01978a6735fe63e78c5e3f","modified":1520401170000},{"_id":"source/_posts/timedatectl.md","hash":"ef6154d8ea0228976783d46afe0d30ea1613d5de","modified":1520401170000},{"_id":"source/tags/index.md","hash":"6339a266bf00be9a47cd54cc212aac4a11bc8c47","modified":1520401170000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1520401170000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"352093a1b210c72136687fd2eee649244cee402c","modified":1520401170000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"902f627155a65099e0a37842ff396a58d0dc306f","modified":1520401170000},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1520401170000},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1520401170000},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1520401170000},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1520401170000},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1520401170000},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1520401170000},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1520401170000},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1520401170000},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1520401170000},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1520401170000},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1520401170000},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1520401170000},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1520401170000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1520401170000},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1520401170000},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1520401170000},{"_id":"themes/next/layout/_layout.swig","hash":"da0929166674ea637e0ad454f85ad0d7bac4aff2","modified":1520401170000},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1520401170000},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1520401170000},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1520401170000},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1520401170000},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1520401170000},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1520401170000},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1520401170000},{"_id":"themes/next/scripts/merge-configs.js","hash":"cb617ddf692f56e6b6129564d52e302f50b28243","modified":1520401170000},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1520401170000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1520401170000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1520401170000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1520401170000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud2.png","hash":"67ac9bdf470677adb9cdb399e32b1f0b104fdaf2","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud6.png","hash":"c97fe7001376ff8359afb9890e798de641dada3e","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud5.png","hash":"9c054e9097d1467ca4433f3d14b3e1cfeb3c2706","modified":1520401170000},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1520401170000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1520401170000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1520401170000},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1520401170000},{"_id":"themes/next/layout/_macro/post.swig","hash":"446a35a2cd389f8cfc3aa38973a9b44ad0740134","modified":1520401170000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1520401170000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"9efc455894921a66bbc074055d3b39c8a34a48a4","modified":1520401170000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1520401170000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1520401170000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"c4d6181f5d3db5365e622f78714af8cc58d7a45e","modified":1520401170000},{"_id":"themes/next/layout/_partials/head.swig","hash":"775d07963021badb3eb864419f36e61df497a5c6","modified":1537946498000},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1520401170000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1520401170000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1520401170000},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1520401170000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1520401170000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1520401170000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1520401170000},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1520401170000},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1520401170000},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1520401170000},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1520401170000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1520401170000},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1520401170000},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1520401170000},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1520401170000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1520401170000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1520401170000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1520401170000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1520401170000},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1520401170000},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1520401170000},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1520401170000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1520401170000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1520401170000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1520401170000},{"_id":"themes/next/source/images/apple-icon-180x180.png","hash":"5c4fcc68f5d16ebadbf09092b0a8ea359ac2349c","modified":1520401170000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1520401170000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1520401170000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1520401170000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1520401170000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1520401170000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1520401170000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1520401170000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1520401170000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1520401170000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1520401170000},{"_id":"themes/next/source/images/favicon-16x16.png","hash":"277d209fb68a803ab37ba5a857fc8c2853a39404","modified":1520401170000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1520401170000},{"_id":"themes/next/source/images/favicon-32x32.png","hash":"ce722d5b180618a4c75d609ae51fe8c437dcda2f","modified":1520401170000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1520401170000},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1520401170000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1520401170000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1520401170000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1520401170000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud1.png","hash":"3456f10df865f274a6e9882e0bf1921e8d411f7c","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud3.png","hash":"bde680ab7c41e852acb22334579a65a8cb1ced59","modified":1520401170000},{"_id":"source/_posts/nextcloud-ceph/nextcloud4.png","hash":"51bdcb2e431fb9b7e0db1ebe7a51033d210e0a02","modified":1520401170000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1520401170000},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1520401170000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1520401170000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1520401170000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1520401170000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1520401170000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1520401170000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1520401170000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1520401170000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1520401170000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1520401170000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1520401170000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1520401170000},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"4617daf810f42b3f3908a40f246538cb1e5970da","modified":1520401170000},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1520401170000},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1520401170000},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1520401170000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1520401170000},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1520401170000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1520401170000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1520401170000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1520401170000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1520401170000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1520401170000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1520401170000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1520401170000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1520401170000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1520401170000},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1520401170000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1520401170000},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1520401170000},{"_id":"themes/next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1520401170000},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1520401170000},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1520401170000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1520401170000},{"_id":"themes/next/source/js/src/utils.js","hash":"dbdc3d1300eec7da9632608ebc0e5b697779dad7","modified":1520401170000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1520401170000},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1520401170000},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1520401170000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1520401170000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1520401170000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1520401170000},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1520401170000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1520401170000},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1520401170000},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1520401170000},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1520401170000},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1520401170000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1520401170000},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1520401170000},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1520401170000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1520401170000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"02fb8fa6b6c252b6bed469539cd057716606a787","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"bcf52192942c0afc410c74a0fb458e7936ddc3d5","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1520401170000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1520401170000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1520401170000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1520401170000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1520401170000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"77c92a449ce84d558d26d052681f2e0dd77c70c9","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1520401170000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1520401170000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1520401170000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1520401170000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1520401170000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1520401170000},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1520401170000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1520401170000}],"Category":[],"Data":[],"Page":[{"title":"tags","date":"2017-07-03T02:11:04.000Z","type":"tags","_content":"\n","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2017-07-03 10:11:04\ntype: \"tags\"\n---\n\n","updated":"2018-03-07T05:39:30.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cjmkr9i1v0001uhv5z88ead6w","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Centos7 修改网卡为ethX","date":"2017-10-10T09:57:57.000Z","_content":"Centos7之后默认的网卡名变成enp0s3这种样子，不再是ethX\n\n通过下面的步骤可以把网卡名变回ethX\n\n+ vim /etc/default/grub\n\n\t在GRUB_CMDLINE_LINUX的最后，加上 <span style=\"color:red\">net.ifnames=0 biosdevname=0</span> 的参数\n\t\n\t```\n\tGRUB_TIMEOUT=5\n\tGRUB_DISTRIBUTOR=”$(sed ‘s, release .*$,,g’ /etc/system-release)”\n\tGRUB_DEFAULT=saved\n\tGRUB_DISABLE_SUBMENU=true\n\tGRUB_TERMINAL_OUTPUT=”console”\n\tGRUB_CMDLINE_LINUX=”rd.lvm.lv=rootvg/usrlv rd.lvm.lv=rootvg/swaplv crashkernel=auto vconsole.keymap=us rd.lvm.lv=rootvg/rootlv vconsole.font=latarcyrheb-sun16 rhgb quiet net.ifnames=0 biosdevname=0”\n\tGRUB_DISABLE_RECOVERY=”true”\n\t```\n\t\n+ grub2-mkconfig -o /boot/grub2/grub.cfg\n+ mv /etc/sysconfig/network-scripts/ifcfg-enp0s3  /etc/sysconfig/network-scripts/ifcfg-eth0\n+ reboot\n\n\n ","source":"_posts/centos-net.md","raw":"---\ntitle: Centos7 修改网卡为ethX\ndate: 2017-10-10 17:57:57\ntags:\n---\nCentos7之后默认的网卡名变成enp0s3这种样子，不再是ethX\n\n通过下面的步骤可以把网卡名变回ethX\n\n+ vim /etc/default/grub\n\n\t在GRUB_CMDLINE_LINUX的最后，加上 <span style=\"color:red\">net.ifnames=0 biosdevname=0</span> 的参数\n\t\n\t```\n\tGRUB_TIMEOUT=5\n\tGRUB_DISTRIBUTOR=”$(sed ‘s, release .*$,,g’ /etc/system-release)”\n\tGRUB_DEFAULT=saved\n\tGRUB_DISABLE_SUBMENU=true\n\tGRUB_TERMINAL_OUTPUT=”console”\n\tGRUB_CMDLINE_LINUX=”rd.lvm.lv=rootvg/usrlv rd.lvm.lv=rootvg/swaplv crashkernel=auto vconsole.keymap=us rd.lvm.lv=rootvg/rootlv vconsole.font=latarcyrheb-sun16 rhgb quiet net.ifnames=0 biosdevname=0”\n\tGRUB_DISABLE_RECOVERY=”true”\n\t```\n\t\n+ grub2-mkconfig -o /boot/grub2/grub.cfg\n+ mv /etc/sysconfig/network-scripts/ifcfg-enp0s3  /etc/sysconfig/network-scripts/ifcfg-eth0\n+ reboot\n\n\n ","slug":"centos-net","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i1r0000uhv53v4k3zpr","content":"<p>Centos7之后默认的网卡名变成enp0s3这种样子，不再是ethX</p>\n<p>通过下面的步骤可以把网卡名变回ethX</p>\n<ul>\n<li><p>vim /etc/default/grub</p>\n<p>  在GRUB_CMDLINE_LINUX的最后，加上 <span style=\"color:red\">net.ifnames=0 biosdevname=0</span> 的参数</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRUB_TIMEOUT=5</span><br><span class=\"line\">GRUB_DISTRIBUTOR=”$(sed ‘s, release .*$,,g’ /etc/system-release)”</span><br><span class=\"line\">GRUB_DEFAULT=saved</span><br><span class=\"line\">GRUB_DISABLE_SUBMENU=true</span><br><span class=\"line\">GRUB_TERMINAL_OUTPUT=”console”</span><br><span class=\"line\">GRUB_CMDLINE_LINUX=”rd.lvm.lv=rootvg/usrlv rd.lvm.lv=rootvg/swaplv crashkernel=auto vconsole.keymap=us rd.lvm.lv=rootvg/rootlv vconsole.font=latarcyrheb-sun16 rhgb quiet net.ifnames=0 biosdevname=0”</span><br><span class=\"line\">GRUB_DISABLE_RECOVERY=”true”</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ul>\n<li>grub2-mkconfig -o /boot/grub2/grub.cfg</li>\n<li>mv /etc/sysconfig/network-scripts/ifcfg-enp0s3  /etc/sysconfig/network-scripts/ifcfg-eth0</li>\n<li>reboot</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Centos7之后默认的网卡名变成enp0s3这种样子，不再是ethX</p>\n<p>通过下面的步骤可以把网卡名变回ethX</p>\n<ul>\n<li><p>vim /etc/default/grub</p>\n<p>  在GRUB_CMDLINE_LINUX的最后，加上 <span style=\"color:red\">net.ifnames=0 biosdevname=0</span> 的参数</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRUB_TIMEOUT=5</span><br><span class=\"line\">GRUB_DISTRIBUTOR=”$(sed ‘s, release .*$,,g’ /etc/system-release)”</span><br><span class=\"line\">GRUB_DEFAULT=saved</span><br><span class=\"line\">GRUB_DISABLE_SUBMENU=true</span><br><span class=\"line\">GRUB_TERMINAL_OUTPUT=”console”</span><br><span class=\"line\">GRUB_CMDLINE_LINUX=”rd.lvm.lv=rootvg/usrlv rd.lvm.lv=rootvg/swaplv crashkernel=auto vconsole.keymap=us rd.lvm.lv=rootvg/rootlv vconsole.font=latarcyrheb-sun16 rhgb quiet net.ifnames=0 biosdevname=0”</span><br><span class=\"line\">GRUB_DISABLE_RECOVERY=”true”</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ul>\n<li>grub2-mkconfig -o /boot/grub2/grub.cfg</li>\n<li>mv /etc/sysconfig/network-scripts/ifcfg-enp0s3  /etc/sysconfig/network-scripts/ifcfg-eth0</li>\n<li>reboot</li>\n</ul>\n"},{"title":"ceph-ansible","date":"2018-02-06T15:13:09.000Z","_content":"\n通过本文了解如果通过ceph-ansible来安装ceph\n\n前提条件\n\n- 配置免密\n- 关闭防火墙\n- 关闭selinux\n\n安装ansible\n\n    pip install ansible==2.3.1.0\n    \n    mkdir /etc/ansible\n    \n    touch /etc/ansible/hosts\n\n下载ceph-ansible\n\n    git clone https://github.com/ceph/ceph-ansible.git\n    \n    cd ceph-ansible\n    \n    git checkout -b stable-3.0 origin/stable-3.0\n\n修改配置\n\n规划好要部署的服务器及组件\n\n例如，需要在ceph0节点上部署mon，mgr和osd，则在/etc/ansible/hosts文件中添加如下内容\n\n    [mons]\n    ceph0\n    \n    [osds]\n    ceph0\n    \n    [mgrs]\n    ceph0\n    \n\n修改ceph-ansible配置\n\n    cd ceph-ansible/group_vars\n    cp all.yml.sample all.yml\n    cp mons.yml.sample mons.yml\n    cp mgrs.yml.sample mgrs.yml\n    cp osds.yml.sample osds.yml\n    \n\n把all.yml文件改成如下内容\n\n    dummy:\n    ceph_origin: repository\n    ceph_repository: community\n    ceph_mirror: http://mirrors.ustc.edu.cn/ceph\n    ceph_stable_key: http://mirrors.ustc.edu.cn/ceph/keys/release.asc\n    ceph_stable_release: luminous\n    ceph_stable_redhat_distro: el7\n    monitor_interface: ens160\n    monitor_address: 0.0.0.0\n    public_network: 123.59.153.0/24\n    cluster_network: 10.10.20.0/24\n    osd_objectstore: bluestore\n    handler_health_osd_check: false\n\n具体配置含义及其他一些配置内容可以参考相应的all.yml.sample\n\nmonitor_interface, public_network 和 cluster_network 根据实际情况调整\n\nosd_objectstore可以选择bluestore和filestore\n\n假设ceph0节点上有3块硬盘（sdb,sdc,sddd）用户部署OSD\n\n把osds.yml 改成如下内容\n\n    ---\n    dummy:\n    devices:\n      - /dev/sdb\n      - /dev/sdc\n      - /dev/sdd\n    osd_scenario: collocated\n\nosds.yml.sample中定了多种osd部署方式，可以根据需要灵活调整。\n\n上面这个例子中，会把一块硬盘分区两个分区，一个分区100M，一个占满磁盘的剩余空间。\n\n100M的分区会作为ceph block, ceph block.db, ceph block.wal, 另一个分区作为 ceph data。\n\n部署ceph\n\n    cd ceph-ansible\n    cp site.yml.sample site.yml\n    \n    ansible-playbook site.yml \n    \n\n修改crush rule\n\n部署完成后默认的crush rule的故障域是host，如果ceph是部署在一个server上，在创建多副本pool的情况下会存在问题。\n\n通过修改crush rule的故障域为osd，可以解决这个问题。\n\n    ceph osd getcrushmap -o crushmap\n    \n    crushtool -d crushmap -o crushmap.txt\n    \n\n修改crushmap.txt 文件中内容如下，把故障域从host改成osd\n\n    rule replicated_rule {\n            id 0\n            type replicated\n            min_size 1\n            max_size 10\n            step take default\n            step chooseleaf firstn 0 type osd\n            step emit\n    }\n    \n\n导入新的crushmap\n\n    crushtool -c crushmap.txt -o crushmap\n    ceph osd setcrushmap -i crushmap\n    \n\n创建POOL\n\n根据需要创建POOL\n\n    ceph osd pool create testpool 32\n    \n\n清理ceph\n\n    cd ceph-ansible\n    \n    cp infrastructure-playbooks/purge-cluster.yml .\n    \n    ansible-playbook purge-cluster.yml\n\n\n","source":"_posts/ceph-ansible.md","raw":"---\ntitle: ceph-ansible\ndate: 2018-02-06 23:13:09\ntags:\n---\n\n通过本文了解如果通过ceph-ansible来安装ceph\n\n前提条件\n\n- 配置免密\n- 关闭防火墙\n- 关闭selinux\n\n安装ansible\n\n    pip install ansible==2.3.1.0\n    \n    mkdir /etc/ansible\n    \n    touch /etc/ansible/hosts\n\n下载ceph-ansible\n\n    git clone https://github.com/ceph/ceph-ansible.git\n    \n    cd ceph-ansible\n    \n    git checkout -b stable-3.0 origin/stable-3.0\n\n修改配置\n\n规划好要部署的服务器及组件\n\n例如，需要在ceph0节点上部署mon，mgr和osd，则在/etc/ansible/hosts文件中添加如下内容\n\n    [mons]\n    ceph0\n    \n    [osds]\n    ceph0\n    \n    [mgrs]\n    ceph0\n    \n\n修改ceph-ansible配置\n\n    cd ceph-ansible/group_vars\n    cp all.yml.sample all.yml\n    cp mons.yml.sample mons.yml\n    cp mgrs.yml.sample mgrs.yml\n    cp osds.yml.sample osds.yml\n    \n\n把all.yml文件改成如下内容\n\n    dummy:\n    ceph_origin: repository\n    ceph_repository: community\n    ceph_mirror: http://mirrors.ustc.edu.cn/ceph\n    ceph_stable_key: http://mirrors.ustc.edu.cn/ceph/keys/release.asc\n    ceph_stable_release: luminous\n    ceph_stable_redhat_distro: el7\n    monitor_interface: ens160\n    monitor_address: 0.0.0.0\n    public_network: 123.59.153.0/24\n    cluster_network: 10.10.20.0/24\n    osd_objectstore: bluestore\n    handler_health_osd_check: false\n\n具体配置含义及其他一些配置内容可以参考相应的all.yml.sample\n\nmonitor_interface, public_network 和 cluster_network 根据实际情况调整\n\nosd_objectstore可以选择bluestore和filestore\n\n假设ceph0节点上有3块硬盘（sdb,sdc,sddd）用户部署OSD\n\n把osds.yml 改成如下内容\n\n    ---\n    dummy:\n    devices:\n      - /dev/sdb\n      - /dev/sdc\n      - /dev/sdd\n    osd_scenario: collocated\n\nosds.yml.sample中定了多种osd部署方式，可以根据需要灵活调整。\n\n上面这个例子中，会把一块硬盘分区两个分区，一个分区100M，一个占满磁盘的剩余空间。\n\n100M的分区会作为ceph block, ceph block.db, ceph block.wal, 另一个分区作为 ceph data。\n\n部署ceph\n\n    cd ceph-ansible\n    cp site.yml.sample site.yml\n    \n    ansible-playbook site.yml \n    \n\n修改crush rule\n\n部署完成后默认的crush rule的故障域是host，如果ceph是部署在一个server上，在创建多副本pool的情况下会存在问题。\n\n通过修改crush rule的故障域为osd，可以解决这个问题。\n\n    ceph osd getcrushmap -o crushmap\n    \n    crushtool -d crushmap -o crushmap.txt\n    \n\n修改crushmap.txt 文件中内容如下，把故障域从host改成osd\n\n    rule replicated_rule {\n            id 0\n            type replicated\n            min_size 1\n            max_size 10\n            step take default\n            step chooseleaf firstn 0 type osd\n            step emit\n    }\n    \n\n导入新的crushmap\n\n    crushtool -c crushmap.txt -o crushmap\n    ceph osd setcrushmap -i crushmap\n    \n\n创建POOL\n\n根据需要创建POOL\n\n    ceph osd pool create testpool 32\n    \n\n清理ceph\n\n    cd ceph-ansible\n    \n    cp infrastructure-playbooks/purge-cluster.yml .\n    \n    ansible-playbook purge-cluster.yml\n\n\n","slug":"ceph-ansible","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i1w0002uhv5brzkltrj","content":"<p>通过本文了解如果通过ceph-ansible来安装ceph</p>\n<p>前提条件</p>\n<ul>\n<li>配置免密</li>\n<li>关闭防火墙</li>\n<li>关闭selinux</li>\n</ul>\n<p>安装ansible</p>\n<pre><code>pip install ansible==2.3.1.0\n\nmkdir /etc/ansible\n\ntouch /etc/ansible/hosts\n</code></pre><p>下载ceph-ansible</p>\n<pre><code>git clone https://github.com/ceph/ceph-ansible.git\n\ncd ceph-ansible\n\ngit checkout -b stable-3.0 origin/stable-3.0\n</code></pre><p>修改配置</p>\n<p>规划好要部署的服务器及组件</p>\n<p>例如，需要在ceph0节点上部署mon，mgr和osd，则在/etc/ansible/hosts文件中添加如下内容</p>\n<pre><code>[mons]\nceph0\n\n[osds]\nceph0\n\n[mgrs]\nceph0\n</code></pre><p>修改ceph-ansible配置</p>\n<pre><code>cd ceph-ansible/group_vars\ncp all.yml.sample all.yml\ncp mons.yml.sample mons.yml\ncp mgrs.yml.sample mgrs.yml\ncp osds.yml.sample osds.yml\n</code></pre><p>把all.yml文件改成如下内容</p>\n<pre><code>dummy:\nceph_origin: repository\nceph_repository: community\nceph_mirror: http://mirrors.ustc.edu.cn/ceph\nceph_stable_key: http://mirrors.ustc.edu.cn/ceph/keys/release.asc\nceph_stable_release: luminous\nceph_stable_redhat_distro: el7\nmonitor_interface: ens160\nmonitor_address: 0.0.0.0\npublic_network: 123.59.153.0/24\ncluster_network: 10.10.20.0/24\nosd_objectstore: bluestore\nhandler_health_osd_check: false\n</code></pre><p>具体配置含义及其他一些配置内容可以参考相应的all.yml.sample</p>\n<p>monitor_interface, public_network 和 cluster_network 根据实际情况调整</p>\n<p>osd_objectstore可以选择bluestore和filestore</p>\n<p>假设ceph0节点上有3块硬盘（sdb,sdc,sddd）用户部署OSD</p>\n<p>把osds.yml 改成如下内容</p>\n<pre><code>---\ndummy:\ndevices:\n  - /dev/sdb\n  - /dev/sdc\n  - /dev/sdd\nosd_scenario: collocated\n</code></pre><p>osds.yml.sample中定了多种osd部署方式，可以根据需要灵活调整。</p>\n<p>上面这个例子中，会把一块硬盘分区两个分区，一个分区100M，一个占满磁盘的剩余空间。</p>\n<p>100M的分区会作为ceph block, ceph block.db, ceph block.wal, 另一个分区作为 ceph data。</p>\n<p>部署ceph</p>\n<pre><code>cd ceph-ansible\ncp site.yml.sample site.yml\n\nansible-playbook site.yml \n</code></pre><p>修改crush rule</p>\n<p>部署完成后默认的crush rule的故障域是host，如果ceph是部署在一个server上，在创建多副本pool的情况下会存在问题。</p>\n<p>通过修改crush rule的故障域为osd，可以解决这个问题。</p>\n<pre><code>ceph osd getcrushmap -o crushmap\n\ncrushtool -d crushmap -o crushmap.txt\n</code></pre><p>修改crushmap.txt 文件中内容如下，把故障域从host改成osd</p>\n<pre><code>rule replicated_rule {\n        id 0\n        type replicated\n        min_size 1\n        max_size 10\n        step take default\n        step chooseleaf firstn 0 type osd\n        step emit\n}\n</code></pre><p>导入新的crushmap</p>\n<pre><code>crushtool -c crushmap.txt -o crushmap\nceph osd setcrushmap -i crushmap\n</code></pre><p>创建POOL</p>\n<p>根据需要创建POOL</p>\n<pre><code>ceph osd pool create testpool 32\n</code></pre><p>清理ceph</p>\n<pre><code>cd ceph-ansible\n\ncp infrastructure-playbooks/purge-cluster.yml .\n\nansible-playbook purge-cluster.yml\n</code></pre>","site":{"data":{}},"excerpt":"","more":"<p>通过本文了解如果通过ceph-ansible来安装ceph</p>\n<p>前提条件</p>\n<ul>\n<li>配置免密</li>\n<li>关闭防火墙</li>\n<li>关闭selinux</li>\n</ul>\n<p>安装ansible</p>\n<pre><code>pip install ansible==2.3.1.0\n\nmkdir /etc/ansible\n\ntouch /etc/ansible/hosts\n</code></pre><p>下载ceph-ansible</p>\n<pre><code>git clone https://github.com/ceph/ceph-ansible.git\n\ncd ceph-ansible\n\ngit checkout -b stable-3.0 origin/stable-3.0\n</code></pre><p>修改配置</p>\n<p>规划好要部署的服务器及组件</p>\n<p>例如，需要在ceph0节点上部署mon，mgr和osd，则在/etc/ansible/hosts文件中添加如下内容</p>\n<pre><code>[mons]\nceph0\n\n[osds]\nceph0\n\n[mgrs]\nceph0\n</code></pre><p>修改ceph-ansible配置</p>\n<pre><code>cd ceph-ansible/group_vars\ncp all.yml.sample all.yml\ncp mons.yml.sample mons.yml\ncp mgrs.yml.sample mgrs.yml\ncp osds.yml.sample osds.yml\n</code></pre><p>把all.yml文件改成如下内容</p>\n<pre><code>dummy:\nceph_origin: repository\nceph_repository: community\nceph_mirror: http://mirrors.ustc.edu.cn/ceph\nceph_stable_key: http://mirrors.ustc.edu.cn/ceph/keys/release.asc\nceph_stable_release: luminous\nceph_stable_redhat_distro: el7\nmonitor_interface: ens160\nmonitor_address: 0.0.0.0\npublic_network: 123.59.153.0/24\ncluster_network: 10.10.20.0/24\nosd_objectstore: bluestore\nhandler_health_osd_check: false\n</code></pre><p>具体配置含义及其他一些配置内容可以参考相应的all.yml.sample</p>\n<p>monitor_interface, public_network 和 cluster_network 根据实际情况调整</p>\n<p>osd_objectstore可以选择bluestore和filestore</p>\n<p>假设ceph0节点上有3块硬盘（sdb,sdc,sddd）用户部署OSD</p>\n<p>把osds.yml 改成如下内容</p>\n<pre><code>---\ndummy:\ndevices:\n  - /dev/sdb\n  - /dev/sdc\n  - /dev/sdd\nosd_scenario: collocated\n</code></pre><p>osds.yml.sample中定了多种osd部署方式，可以根据需要灵活调整。</p>\n<p>上面这个例子中，会把一块硬盘分区两个分区，一个分区100M，一个占满磁盘的剩余空间。</p>\n<p>100M的分区会作为ceph block, ceph block.db, ceph block.wal, 另一个分区作为 ceph data。</p>\n<p>部署ceph</p>\n<pre><code>cd ceph-ansible\ncp site.yml.sample site.yml\n\nansible-playbook site.yml \n</code></pre><p>修改crush rule</p>\n<p>部署完成后默认的crush rule的故障域是host，如果ceph是部署在一个server上，在创建多副本pool的情况下会存在问题。</p>\n<p>通过修改crush rule的故障域为osd，可以解决这个问题。</p>\n<pre><code>ceph osd getcrushmap -o crushmap\n\ncrushtool -d crushmap -o crushmap.txt\n</code></pre><p>修改crushmap.txt 文件中内容如下，把故障域从host改成osd</p>\n<pre><code>rule replicated_rule {\n        id 0\n        type replicated\n        min_size 1\n        max_size 10\n        step take default\n        step chooseleaf firstn 0 type osd\n        step emit\n}\n</code></pre><p>导入新的crushmap</p>\n<pre><code>crushtool -c crushmap.txt -o crushmap\nceph osd setcrushmap -i crushmap\n</code></pre><p>创建POOL</p>\n<p>根据需要创建POOL</p>\n<pre><code>ceph osd pool create testpool 32\n</code></pre><p>清理ceph</p>\n<pre><code>cd ceph-ansible\n\ncp infrastructure-playbooks/purge-cluster.yml .\n\nansible-playbook purge-cluster.yml\n</code></pre>"},{"title":"Git patch","date":"2018-03-08T06:01:19.000Z","_content":"git format-patch适用于git的patch，包含diff信息，包含提交人，提交时间等 如果生成的补丁不能打到当前分支，git am会给出提示，并协助你完成打补丁工作\n\n## 对比分支生成patch\n\n例：从master checkout 一个新分支修改然后与master对比生成patch。\n\n```bash\n$ git format-patch -M master   # -M选项表示这个patch要和那个分支比对\n$ git am 001-xxx.patch         # 不必重新commit\n```\n\n## 将commit打包成patch\n\n```bash\n$ git format-patch 1bbe3c8c19 # 从1bbe3c8c19往后的全部commit,不包括1bbe3c8c19\n\ngit format-patch -n 1bbe3c8c19 # 1bbe3c8c19开始n个commit，包含1bbe3c8c19\n\n$ git format-patch HEAD^      # 最近的1次commit的patch\n$ git format-patch HEAD^^     # 最近的2次commit的patch\n$ git format-patch HEAD^^^    # 最近的3次commit的patch\n\n$ git format-patch -1         # 同HEAD^  \n$ git format-patch -2         # 同HEAD^^\n$ git format-patch -3         # 同HEAD^^^\n\n$ git format-patch -1 -4      # -1到-4之间的commit，包括-1和-4\n\n$ git format-patch <ref1>..<ref2>  ## 在两个commit之间，包括ref1和ref2 \n```\n\n## patch合并到一个文件\n\n默认情况下，每一个commit都会产生一个patch文件，下面的操作可以把全部commit合并到一个文件中\n\n```bash\n$ git format-path 1bbe3c8c19 --stdout > xxx.patch\n```\n\n## 应用patch\n\n```bash\n# 检查patch文件\n$ git apply --stat xxx.patch\n\n#查看是否能应用成功\n$ git apply --check xxx.patch\n\n# 应用patch\n$ git am -s < xxx.patch\n```","source":"_posts/git-patch.md","raw":"---\ntitle: Git patch\ndate: 2018-03-08 14:01:19\ntags: git\n---\ngit format-patch适用于git的patch，包含diff信息，包含提交人，提交时间等 如果生成的补丁不能打到当前分支，git am会给出提示，并协助你完成打补丁工作\n\n## 对比分支生成patch\n\n例：从master checkout 一个新分支修改然后与master对比生成patch。\n\n```bash\n$ git format-patch -M master   # -M选项表示这个patch要和那个分支比对\n$ git am 001-xxx.patch         # 不必重新commit\n```\n\n## 将commit打包成patch\n\n```bash\n$ git format-patch 1bbe3c8c19 # 从1bbe3c8c19往后的全部commit,不包括1bbe3c8c19\n\ngit format-patch -n 1bbe3c8c19 # 1bbe3c8c19开始n个commit，包含1bbe3c8c19\n\n$ git format-patch HEAD^      # 最近的1次commit的patch\n$ git format-patch HEAD^^     # 最近的2次commit的patch\n$ git format-patch HEAD^^^    # 最近的3次commit的patch\n\n$ git format-patch -1         # 同HEAD^  \n$ git format-patch -2         # 同HEAD^^\n$ git format-patch -3         # 同HEAD^^^\n\n$ git format-patch -1 -4      # -1到-4之间的commit，包括-1和-4\n\n$ git format-patch <ref1>..<ref2>  ## 在两个commit之间，包括ref1和ref2 \n```\n\n## patch合并到一个文件\n\n默认情况下，每一个commit都会产生一个patch文件，下面的操作可以把全部commit合并到一个文件中\n\n```bash\n$ git format-path 1bbe3c8c19 --stdout > xxx.patch\n```\n\n## 应用patch\n\n```bash\n# 检查patch文件\n$ git apply --stat xxx.patch\n\n#查看是否能应用成功\n$ git apply --check xxx.patch\n\n# 应用patch\n$ git am -s < xxx.patch\n```","slug":"git-patch","published":1,"updated":"2018-03-08T07:04:17.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i200003uhv585atfqxo","content":"<p>git format-patch适用于git的patch，包含diff信息，包含提交人，提交时间等 如果生成的补丁不能打到当前分支，git am会给出提示，并协助你完成打补丁工作</p>\n<h2 id=\"对比分支生成patch\"><a href=\"#对比分支生成patch\" class=\"headerlink\" title=\"对比分支生成patch\"></a>对比分支生成patch</h2><p>例：从master checkout 一个新分支修改然后与master对比生成patch。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-patch -M master   <span class=\"comment\"># -M选项表示这个patch要和那个分支比对</span></span><br><span class=\"line\">$ git am 001-xxx.patch         <span class=\"comment\"># 不必重新commit</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"将commit打包成patch\"><a href=\"#将commit打包成patch\" class=\"headerlink\" title=\"将commit打包成patch\"></a>将commit打包成patch</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-patch 1bbe3c8c19 <span class=\"comment\"># 从1bbe3c8c19往后的全部commit,不包括1bbe3c8c19</span></span><br><span class=\"line\"></span><br><span class=\"line\">git format-patch -n 1bbe3c8c19 <span class=\"comment\"># 1bbe3c8c19开始n个commit，包含1bbe3c8c19</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch HEAD^      <span class=\"comment\"># 最近的1次commit的patch</span></span><br><span class=\"line\">$ git format-patch HEAD^^     <span class=\"comment\"># 最近的2次commit的patch</span></span><br><span class=\"line\">$ git format-patch HEAD^^^    <span class=\"comment\"># 最近的3次commit的patch</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch -1         <span class=\"comment\"># 同HEAD^  </span></span><br><span class=\"line\">$ git format-patch -2         <span class=\"comment\"># 同HEAD^^</span></span><br><span class=\"line\">$ git format-patch -3         <span class=\"comment\"># 同HEAD^^^</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch -1 -4      <span class=\"comment\"># -1到-4之间的commit，包括-1和-4</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch &lt;ref1&gt;..&lt;ref2&gt;  <span class=\"comment\">## 在两个commit之间，包括ref1和ref2</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"patch合并到一个文件\"><a href=\"#patch合并到一个文件\" class=\"headerlink\" title=\"patch合并到一个文件\"></a>patch合并到一个文件</h2><p>默认情况下，每一个commit都会产生一个patch文件，下面的操作可以把全部commit合并到一个文件中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-path 1bbe3c8c19 --stdout &gt; xxx.patch</span><br></pre></td></tr></table></figure>\n<h2 id=\"应用patch\"><a href=\"#应用patch\" class=\"headerlink\" title=\"应用patch\"></a>应用patch</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 检查patch文件</span></span><br><span class=\"line\">$ git apply --<span class=\"built_in\">stat</span> xxx.patch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#查看是否能应用成功</span></span><br><span class=\"line\">$ git apply --check xxx.patch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 应用patch</span></span><br><span class=\"line\">$ git am -s &lt; xxx.patch</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>git format-patch适用于git的patch，包含diff信息，包含提交人，提交时间等 如果生成的补丁不能打到当前分支，git am会给出提示，并协助你完成打补丁工作</p>\n<h2 id=\"对比分支生成patch\"><a href=\"#对比分支生成patch\" class=\"headerlink\" title=\"对比分支生成patch\"></a>对比分支生成patch</h2><p>例：从master checkout 一个新分支修改然后与master对比生成patch。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-patch -M master   <span class=\"comment\"># -M选项表示这个patch要和那个分支比对</span></span><br><span class=\"line\">$ git am 001-xxx.patch         <span class=\"comment\"># 不必重新commit</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"将commit打包成patch\"><a href=\"#将commit打包成patch\" class=\"headerlink\" title=\"将commit打包成patch\"></a>将commit打包成patch</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-patch 1bbe3c8c19 <span class=\"comment\"># 从1bbe3c8c19往后的全部commit,不包括1bbe3c8c19</span></span><br><span class=\"line\"></span><br><span class=\"line\">git format-patch -n 1bbe3c8c19 <span class=\"comment\"># 1bbe3c8c19开始n个commit，包含1bbe3c8c19</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch HEAD^      <span class=\"comment\"># 最近的1次commit的patch</span></span><br><span class=\"line\">$ git format-patch HEAD^^     <span class=\"comment\"># 最近的2次commit的patch</span></span><br><span class=\"line\">$ git format-patch HEAD^^^    <span class=\"comment\"># 最近的3次commit的patch</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch -1         <span class=\"comment\"># 同HEAD^  </span></span><br><span class=\"line\">$ git format-patch -2         <span class=\"comment\"># 同HEAD^^</span></span><br><span class=\"line\">$ git format-patch -3         <span class=\"comment\"># 同HEAD^^^</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch -1 -4      <span class=\"comment\"># -1到-4之间的commit，包括-1和-4</span></span><br><span class=\"line\"></span><br><span class=\"line\">$ git format-patch &lt;ref1&gt;..&lt;ref2&gt;  <span class=\"comment\">## 在两个commit之间，包括ref1和ref2</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"patch合并到一个文件\"><a href=\"#patch合并到一个文件\" class=\"headerlink\" title=\"patch合并到一个文件\"></a>patch合并到一个文件</h2><p>默认情况下，每一个commit都会产生一个patch文件，下面的操作可以把全部commit合并到一个文件中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git format-path 1bbe3c8c19 --stdout &gt; xxx.patch</span><br></pre></td></tr></table></figure>\n<h2 id=\"应用patch\"><a href=\"#应用patch\" class=\"headerlink\" title=\"应用patch\"></a>应用patch</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 检查patch文件</span></span><br><span class=\"line\">$ git apply --<span class=\"built_in\">stat</span> xxx.patch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#查看是否能应用成功</span></span><br><span class=\"line\">$ git apply --check xxx.patch</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 应用patch</span></span><br><span class=\"line\">$ git am -s &lt; xxx.patch</span><br></pre></td></tr></table></figure>"},{"title":"logrotate","date":"2017-09-26T07:32:23.000Z","_content":"\n通过logroate，可以对日志文件进行切分，压缩，配置保留多少天等\n\n下面两篇文件对logrotate的配置介绍的很详细\n\n<https://support.rackspace.com/how-to/understanding-logrotate-utility/>\n\n<https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/>\n","source":"_posts/logrotate.md","raw":"---\ntitle: logrotate\ndate: 2017-09-26 15:32:23\ntags:\n---\n\n通过logroate，可以对日志文件进行切分，压缩，配置保留多少天等\n\n下面两篇文件对logrotate的配置介绍的很详细\n\n<https://support.rackspace.com/how-to/understanding-logrotate-utility/>\n\n<https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/>\n","slug":"logrotate","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i210004uhv5p9reoee6","content":"<p>通过logroate，可以对日志文件进行切分，压缩，配置保留多少天等</p>\n<p>下面两篇文件对logrotate的配置介绍的很详细</p>\n<p><a href=\"https://support.rackspace.com/how-to/understanding-logrotate-utility/\" target=\"_blank\" rel=\"noopener\">https://support.rackspace.com/how-to/understanding-logrotate-utility/</a></p>\n<p><a href=\"https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/\" target=\"_blank\" rel=\"noopener\">https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>通过logroate，可以对日志文件进行切分，压缩，配置保留多少天等</p>\n<p>下面两篇文件对logrotate的配置介绍的很详细</p>\n<p><a href=\"https://support.rackspace.com/how-to/understanding-logrotate-utility/\" target=\"_blank\" rel=\"noopener\">https://support.rackspace.com/how-to/understanding-logrotate-utility/</a></p>\n<p><a href=\"https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/\" target=\"_blank\" rel=\"noopener\">https://support.rackspace.com/how-to/sample-logrotate-configuration-and-troubleshooting/</a></p>\n"},{"title":"mysql主从复制","date":"2018-03-02T09:23:27.000Z","_content":"\n## 环境\nOS：Centos 7.3\n\nDB version： mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1\n\nhost1(master): 172.16.143.171\n\nhost2(slave): 172.16.143.172\n\n## 安装\n\n两个节点都执行下面的步骤\n\n```bash\nyum install mariadb-server -y\n\nsystemctl start mariadb\n```\n执行db安全选项\n\n```bash\nmysql_secure_installation\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MariaDB to secure it, we'll need the current\npassword for the root user.  If you've just installed MariaDB, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MariaDB\nroot user without the proper authorisation.\n\nYou already have a root password set, so you can safely answer 'n'.\n\nChange the root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n\nBy default, a MariaDB installation has an anonymous user, allowing anyone\nto log into MariaDB without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] Y\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] Y\n ... Success!\n\nBy default, MariaDB comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] Y\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] Y\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks for using MariaDB!\n\n```\n\n### master节点配置\n\n在/etc/my.cnf文件的[mysqld]中添加如下内容\n\n```vim\nserver-id=1\nlog-bin = /var/lib/mysql/mysql-bin\nbinlog-ignore-db=mysql\nbinlog-ignore-db=information_schema\nbinlog-ignore-db=performance_schema\n```\n\n重启db\n\n```bash\nsystemctl restart mariadb\n```\n\n```bash\nmysql -u root -p\n\nGRANT REPLICATION SLAVE ON *.* TO 'replic_user'@'%' IDENTIFIED BY 'password';\n\nFLUSH PRIVILEGES;\n\nSHOW MASTER STATUS;\n\nQUIT;\n```\n\n如果 master 中已经存在需要复制的数据，则需要dump出来，然后在slave上重放\n\n```bash\nmysql -u root -p\n\nmysql> FLUSH TABLES WITH READ LOCK;\n\nmysql> SHOW MASTER STATUS;\n\n```\n\n```bash\nmysqldump -u root -p --databases [database-1] [database-2] ...  > /root/db_dump.sql\n\nmysql -u root -p\nmysql> UNLOCK TABLES;\n\n```\n\n### slave节点配置\n\n如果master节点上dump了数据，则需要执行下面的步骤进行重放。\n\n```bash\nscp root@172.16.143.171:/root/db_dump.sql /root/db_dump.sql\nmysql -u root -p < /root/db_dump.sql\n```\n\n在/etc/my.cnf文件的[mysqld]中添加如下内容\n\n```vim\nserver-id=2\nog-bin = /var/lib/mysql/mysql-bin\nbinlog-ignore-db=mysql\nbinlog-ignore-db=information_schema\nbinlog-ignore-db=performance_schema\n```\n重启db\n\n```bash\nsystemctl restart mariadb\n```\n\n```bash\nmysql -u root -p\n\nmysql> CHANGE MASTER TO MASTER_HOST='172.16.143.171',MASTER_USER='replic_user', MASTER_PASSWORD='password', MASTER_LOG_FILE='mysql-bin.000001', MASTER_LOG_POS=107;\n```\n上面命令中<b>MASTER_LOG_FILE</b> 和 <b>MASTER_LOG_POS</b> 需要根据master节点中```show master status```命令结果调整。\n\n```bash\nSTART SLAVE;\n\nSHOW SLAVE STATUS\\G\n```\n\n## 测试\n在master节点中创建db，也可以在slave节点中看到。\n\n## 双向复制\n上面的配置实现了host1 --> host2 的复制关系，如需要实现双向复制，只需要按照上面的步骤再配置从 host2 --> host1 的复制关机即可。\n\n另外在host1的/ect/my.cnf中添加如下内容\n\n```bash\nauto-increment-increment = 2\nauto-increment-offset = 1\n```\n\n在host2的/ect/my.cnf中添加如下内容\n\n```bash\nauto-increment-increment = 2\nauto-increment-offset = 2\n```\n","source":"_posts/mysql-replication.md","raw":"---\ntitle: mysql主从复制\ndate: 2018-03-02 17:23:27\ntags: ['linux','mysql','ha']\n---\n\n## 环境\nOS：Centos 7.3\n\nDB version： mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1\n\nhost1(master): 172.16.143.171\n\nhost2(slave): 172.16.143.172\n\n## 安装\n\n两个节点都执行下面的步骤\n\n```bash\nyum install mariadb-server -y\n\nsystemctl start mariadb\n```\n执行db安全选项\n\n```bash\nmysql_secure_installation\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MariaDB to secure it, we'll need the current\npassword for the root user.  If you've just installed MariaDB, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MariaDB\nroot user without the proper authorisation.\n\nYou already have a root password set, so you can safely answer 'n'.\n\nChange the root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n\nBy default, a MariaDB installation has an anonymous user, allowing anyone\nto log into MariaDB without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] Y\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] Y\n ... Success!\n\nBy default, MariaDB comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] Y\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] Y\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks for using MariaDB!\n\n```\n\n### master节点配置\n\n在/etc/my.cnf文件的[mysqld]中添加如下内容\n\n```vim\nserver-id=1\nlog-bin = /var/lib/mysql/mysql-bin\nbinlog-ignore-db=mysql\nbinlog-ignore-db=information_schema\nbinlog-ignore-db=performance_schema\n```\n\n重启db\n\n```bash\nsystemctl restart mariadb\n```\n\n```bash\nmysql -u root -p\n\nGRANT REPLICATION SLAVE ON *.* TO 'replic_user'@'%' IDENTIFIED BY 'password';\n\nFLUSH PRIVILEGES;\n\nSHOW MASTER STATUS;\n\nQUIT;\n```\n\n如果 master 中已经存在需要复制的数据，则需要dump出来，然后在slave上重放\n\n```bash\nmysql -u root -p\n\nmysql> FLUSH TABLES WITH READ LOCK;\n\nmysql> SHOW MASTER STATUS;\n\n```\n\n```bash\nmysqldump -u root -p --databases [database-1] [database-2] ...  > /root/db_dump.sql\n\nmysql -u root -p\nmysql> UNLOCK TABLES;\n\n```\n\n### slave节点配置\n\n如果master节点上dump了数据，则需要执行下面的步骤进行重放。\n\n```bash\nscp root@172.16.143.171:/root/db_dump.sql /root/db_dump.sql\nmysql -u root -p < /root/db_dump.sql\n```\n\n在/etc/my.cnf文件的[mysqld]中添加如下内容\n\n```vim\nserver-id=2\nog-bin = /var/lib/mysql/mysql-bin\nbinlog-ignore-db=mysql\nbinlog-ignore-db=information_schema\nbinlog-ignore-db=performance_schema\n```\n重启db\n\n```bash\nsystemctl restart mariadb\n```\n\n```bash\nmysql -u root -p\n\nmysql> CHANGE MASTER TO MASTER_HOST='172.16.143.171',MASTER_USER='replic_user', MASTER_PASSWORD='password', MASTER_LOG_FILE='mysql-bin.000001', MASTER_LOG_POS=107;\n```\n上面命令中<b>MASTER_LOG_FILE</b> 和 <b>MASTER_LOG_POS</b> 需要根据master节点中```show master status```命令结果调整。\n\n```bash\nSTART SLAVE;\n\nSHOW SLAVE STATUS\\G\n```\n\n## 测试\n在master节点中创建db，也可以在slave节点中看到。\n\n## 双向复制\n上面的配置实现了host1 --> host2 的复制关系，如需要实现双向复制，只需要按照上面的步骤再配置从 host2 --> host1 的复制关机即可。\n\n另外在host1的/ect/my.cnf中添加如下内容\n\n```bash\nauto-increment-increment = 2\nauto-increment-offset = 1\n```\n\n在host2的/ect/my.cnf中添加如下内容\n\n```bash\nauto-increment-increment = 2\nauto-increment-offset = 2\n```\n","slug":"mysql-replication","published":1,"updated":"2018-09-26T03:47:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i240006uhv5esdpxn1b","content":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS：Centos 7.3</p>\n<p>DB version： mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1</p>\n<p>host1(master): 172.16.143.171</p>\n<p>host2(slave): 172.16.143.172</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>两个节点都执行下面的步骤</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mariadb-server -y</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start mariadb</span><br></pre></td></tr></table></figure>\n<p>执行db安全选项</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br><span class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class=\"line\"></span><br><span class=\"line\">In order to <span class=\"built_in\">log</span> into MariaDB to secure it, we<span class=\"string\">'ll need the current</span></span><br><span class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MariaDB, and</span><br><span class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></span><br><span class=\"line\"><span class=\"string\">so you should just press enter here.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MariaDB</span></span><br><span class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">You already have a root password set, so you can safely answer '</span>n<span class=\"string\">'.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Change the root password? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\">New password:</span></span><br><span class=\"line\"><span class=\"string\">Re-enter new password:</span></span><br><span class=\"line\"><span class=\"string\">Password updated successfully!</span></span><br><span class=\"line\"><span class=\"string\">Reloading privilege tables..</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">By default, a MariaDB installation has an anonymous user, allowing anyone</span></span><br><span class=\"line\"><span class=\"string\">to log into MariaDB without having to have a user account created for</span></span><br><span class=\"line\"><span class=\"string\">them.  This is intended only for testing, and to make the installation</span></span><br><span class=\"line\"><span class=\"string\">go a bit smoother.  You should remove them before moving into a</span></span><br><span class=\"line\"><span class=\"string\">production environment.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Remove anonymous users? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Normally, root should only be allowed to connect from '</span>localhost<span class=\"string\">'.  This</span></span><br><span class=\"line\"><span class=\"string\">ensures that someone cannot guess at the root password from the network.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Disallow root login remotely? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">By default, MariaDB comes with a database named '</span><span class=\"built_in\">test</span><span class=\"string\">' that anyone can</span></span><br><span class=\"line\"><span class=\"string\">access.  This is also intended only for testing, and should be removed</span></span><br><span class=\"line\"><span class=\"string\">before moving into a production environment.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Remove test database and access to it? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> - Dropping test database...</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"> - Removing privileges on test database...</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Reloading the privilege tables will ensure that all changes made so far</span></span><br><span class=\"line\"><span class=\"string\">will take effect immediately.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Reload privilege tables now? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Cleaning up...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">All done!  If you'</span>ve completed all of the above steps, your MariaDB</span><br><span class=\"line\">installation should now be secure.</span><br><span class=\"line\"></span><br><span class=\"line\">Thanks <span class=\"keyword\">for</span> using MariaDB!</span><br></pre></td></tr></table></figure>\n<h3 id=\"master节点配置\"><a href=\"#master节点配置\" class=\"headerlink\" title=\"master节点配置\"></a>master节点配置</h3><p>在/etc/my.cnf文件的[mysqld]中添加如下内容</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">log</span>-bin = /var/lib/mysql/mysql-bin</span><br><span class=\"line\">binlog-ignore-db=mysql</span><br><span class=\"line\">binlog-ignore-db=information_schema</span><br><span class=\"line\">binlog-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>\n<p>重启db</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart mariadb</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">GRANT REPLICATION SLAVE ON *.* TO <span class=\"string\">'replic_user'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'password'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\"></span><br><span class=\"line\">SHOW MASTER STATUS;</span><br><span class=\"line\"></span><br><span class=\"line\">QUIT;</span><br></pre></td></tr></table></figure>\n<p>如果 master 中已经存在需要复制的数据，则需要dump出来，然后在slave上重放</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; FLUSH TABLES WITH READ LOCK;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SHOW MASTER STATUS;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -u root -p --databases [database-1] [database-2] ...  &gt; /root/db_dump.sql</span><br><span class=\"line\"></span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; UNLOCK TABLES;</span><br></pre></td></tr></table></figure>\n<h3 id=\"slave节点配置\"><a href=\"#slave节点配置\" class=\"headerlink\" title=\"slave节点配置\"></a>slave节点配置</h3><p>如果master节点上dump了数据，则需要执行下面的步骤进行重放。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp root@172.16.143.171:/root/db_dump.sql /root/db_dump.sql</span><br><span class=\"line\">mysql -u root -p &lt; /root/db_dump.sql</span><br></pre></td></tr></table></figure>\n<p>在/etc/my.cnf文件的[mysqld]中添加如下内容</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=<span class=\"number\">2</span></span><br><span class=\"line\">og-bin = /var/lib/mysql/mysql-bin</span><br><span class=\"line\">binlog-ignore-db=mysql</span><br><span class=\"line\">binlog-ignore-db=information_schema</span><br><span class=\"line\">binlog-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>\n<p>重启db</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart mariadb</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CHANGE MASTER TO MASTER_HOST=<span class=\"string\">'172.16.143.171'</span>,MASTER_USER=<span class=\"string\">'replic_user'</span>, MASTER_PASSWORD=<span class=\"string\">'password'</span>, MASTER_LOG_FILE=<span class=\"string\">'mysql-bin.000001'</span>, MASTER_LOG_POS=107;</span><br></pre></td></tr></table></figure>\n<p>上面命令中<b>MASTER_LOG_FILE</b> 和 <b>MASTER_LOG_POS</b> 需要根据master节点中<figure class=\"highlight plain\"><figcaption><span>master status```命令结果调整。</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">```bash</span><br><span class=\"line\">START SLAVE;</span><br><span class=\"line\"></span><br><span class=\"line\">SHOW SLAVE STATUS\\G</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>在master节点中创建db，也可以在slave节点中看到。</p>\n<h2 id=\"双向复制\"><a href=\"#双向复制\" class=\"headerlink\" title=\"双向复制\"></a>双向复制</h2><p>上面的配置实现了host1 –&gt; host2 的复制关系，如需要实现双向复制，只需要按照上面的步骤再配置从 host2 –&gt; host1 的复制关机即可。</p>\n<p>另外在host1的/ect/my.cnf中添加如下内容</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto-increment-increment = 2</span><br><span class=\"line\">auto-increment-offset = 1</span><br></pre></td></tr></table></figure>\n<p>在host2的/ect/my.cnf中添加如下内容</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto-increment-increment = 2</span><br><span class=\"line\">auto-increment-offset = 2</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS：Centos 7.3</p>\n<p>DB version： mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1</p>\n<p>host1(master): 172.16.143.171</p>\n<p>host2(slave): 172.16.143.172</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>两个节点都执行下面的步骤</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mariadb-server -y</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start mariadb</span><br></pre></td></tr></table></figure>\n<p>执行db安全选项</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br><span class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class=\"line\"></span><br><span class=\"line\">In order to <span class=\"built_in\">log</span> into MariaDB to secure it, we<span class=\"string\">'ll need the current</span></span><br><span class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MariaDB, and</span><br><span class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></span><br><span class=\"line\"><span class=\"string\">so you should just press enter here.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MariaDB</span></span><br><span class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">You already have a root password set, so you can safely answer '</span>n<span class=\"string\">'.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Change the root password? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\">New password:</span></span><br><span class=\"line\"><span class=\"string\">Re-enter new password:</span></span><br><span class=\"line\"><span class=\"string\">Password updated successfully!</span></span><br><span class=\"line\"><span class=\"string\">Reloading privilege tables..</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">By default, a MariaDB installation has an anonymous user, allowing anyone</span></span><br><span class=\"line\"><span class=\"string\">to log into MariaDB without having to have a user account created for</span></span><br><span class=\"line\"><span class=\"string\">them.  This is intended only for testing, and to make the installation</span></span><br><span class=\"line\"><span class=\"string\">go a bit smoother.  You should remove them before moving into a</span></span><br><span class=\"line\"><span class=\"string\">production environment.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Remove anonymous users? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Normally, root should only be allowed to connect from '</span>localhost<span class=\"string\">'.  This</span></span><br><span class=\"line\"><span class=\"string\">ensures that someone cannot guess at the root password from the network.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Disallow root login remotely? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">By default, MariaDB comes with a database named '</span><span class=\"built_in\">test</span><span class=\"string\">' that anyone can</span></span><br><span class=\"line\"><span class=\"string\">access.  This is also intended only for testing, and should be removed</span></span><br><span class=\"line\"><span class=\"string\">before moving into a production environment.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Remove test database and access to it? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> - Dropping test database...</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"> - Removing privileges on test database...</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Reloading the privilege tables will ensure that all changes made so far</span></span><br><span class=\"line\"><span class=\"string\">will take effect immediately.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Reload privilege tables now? [Y/n] Y</span></span><br><span class=\"line\"><span class=\"string\"> ... Success!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Cleaning up...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">All done!  If you'</span>ve completed all of the above steps, your MariaDB</span><br><span class=\"line\">installation should now be secure.</span><br><span class=\"line\"></span><br><span class=\"line\">Thanks <span class=\"keyword\">for</span> using MariaDB!</span><br></pre></td></tr></table></figure>\n<h3 id=\"master节点配置\"><a href=\"#master节点配置\" class=\"headerlink\" title=\"master节点配置\"></a>master节点配置</h3><p>在/etc/my.cnf文件的[mysqld]中添加如下内容</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">log</span>-bin = /var/lib/mysql/mysql-bin</span><br><span class=\"line\">binlog-ignore-db=mysql</span><br><span class=\"line\">binlog-ignore-db=information_schema</span><br><span class=\"line\">binlog-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>\n<p>重启db</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart mariadb</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">GRANT REPLICATION SLAVE ON *.* TO <span class=\"string\">'replic_user'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'password'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\"></span><br><span class=\"line\">SHOW MASTER STATUS;</span><br><span class=\"line\"></span><br><span class=\"line\">QUIT;</span><br></pre></td></tr></table></figure>\n<p>如果 master 中已经存在需要复制的数据，则需要dump出来，然后在slave上重放</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; FLUSH TABLES WITH READ LOCK;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SHOW MASTER STATUS;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -u root -p --databases [database-1] [database-2] ...  &gt; /root/db_dump.sql</span><br><span class=\"line\"></span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; UNLOCK TABLES;</span><br></pre></td></tr></table></figure>\n<h3 id=\"slave节点配置\"><a href=\"#slave节点配置\" class=\"headerlink\" title=\"slave节点配置\"></a>slave节点配置</h3><p>如果master节点上dump了数据，则需要执行下面的步骤进行重放。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp root@172.16.143.171:/root/db_dump.sql /root/db_dump.sql</span><br><span class=\"line\">mysql -u root -p &lt; /root/db_dump.sql</span><br></pre></td></tr></table></figure>\n<p>在/etc/my.cnf文件的[mysqld]中添加如下内容</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=<span class=\"number\">2</span></span><br><span class=\"line\">og-bin = /var/lib/mysql/mysql-bin</span><br><span class=\"line\">binlog-ignore-db=mysql</span><br><span class=\"line\">binlog-ignore-db=information_schema</span><br><span class=\"line\">binlog-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>\n<p>重启db</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart mariadb</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CHANGE MASTER TO MASTER_HOST=<span class=\"string\">'172.16.143.171'</span>,MASTER_USER=<span class=\"string\">'replic_user'</span>, MASTER_PASSWORD=<span class=\"string\">'password'</span>, MASTER_LOG_FILE=<span class=\"string\">'mysql-bin.000001'</span>, MASTER_LOG_POS=107;</span><br></pre></td></tr></table></figure>\n<p>上面命令中<b>MASTER_LOG_FILE</b> 和 <b>MASTER_LOG_POS</b> 需要根据master节点中<figure class=\"highlight plain\"><figcaption><span>master status```命令结果调整。</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">```bash</span><br><span class=\"line\">START SLAVE;</span><br><span class=\"line\"></span><br><span class=\"line\">SHOW SLAVE STATUS\\G</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>在master节点中创建db，也可以在slave节点中看到。</p>\n<h2 id=\"双向复制\"><a href=\"#双向复制\" class=\"headerlink\" title=\"双向复制\"></a>双向复制</h2><p>上面的配置实现了host1 –&gt; host2 的复制关系，如需要实现双向复制，只需要按照上面的步骤再配置从 host2 –&gt; host1 的复制关机即可。</p>\n<p>另外在host1的/ect/my.cnf中添加如下内容</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto-increment-increment = 2</span><br><span class=\"line\">auto-increment-offset = 1</span><br></pre></td></tr></table></figure>\n<p>在host2的/ect/my.cnf中添加如下内容</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto-increment-increment = 2</span><br><span class=\"line\">auto-increment-offset = 2</span><br></pre></td></tr></table></figure>\n"},{"title":"nextcloud对接ceph","date":"2017-08-09T06:38:45.000Z","_content":"nextcloud是一个私有网盘解决方案，支持多种后端存储解决方案。\nnextcloud也支持aws的s3, 而ceph的radosgw也是兼容s3协议的，所以nextcloud也可以使用ceph作为后端存储，具体的配置如下\n{% asset_img nextcloud1.png 找到插件 %}\n{% asset_img nextcloud2.png enable插件 %}\n{% asset_img nextcloud3.png 添加ceph rgw %}\n填写ceph rgw的server和port，access_key,secret_key,enable path style\n\n{% asset_img nextcloud4.png 找到对应的文件夹 %}\n{% asset_img nextcloud5.png 上传文件 %}\n{% asset_img nextcloud6.png 在Ceph rgw中查看文件 %}\n","source":"_posts/nextcloud-ceph.md","raw":"---\ntitle: nextcloud对接ceph\ndate: 2017-08-09 14:38:45\ntags:\n---\nnextcloud是一个私有网盘解决方案，支持多种后端存储解决方案。\nnextcloud也支持aws的s3, 而ceph的radosgw也是兼容s3协议的，所以nextcloud也可以使用ceph作为后端存储，具体的配置如下\n{% asset_img nextcloud1.png 找到插件 %}\n{% asset_img nextcloud2.png enable插件 %}\n{% asset_img nextcloud3.png 添加ceph rgw %}\n填写ceph rgw的server和port，access_key,secret_key,enable path style\n\n{% asset_img nextcloud4.png 找到对应的文件夹 %}\n{% asset_img nextcloud5.png 上传文件 %}\n{% asset_img nextcloud6.png 在Ceph rgw中查看文件 %}\n","slug":"nextcloud-ceph","published":1,"updated":"2018-09-26T03:58:13.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i260007uhv5kyjdoeun","content":"<p>nextcloud是一个私有网盘解决方案，支持多种后端存储解决方案。<br>nextcloud也支持aws的s3, 而ceph的radosgw也是兼容s3协议的，所以nextcloud也可以使用ceph作为后端存储，具体的配置如下<br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud1.png\" title=\"找到插件\"><br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud2.png\" title=\"enable插件\"><br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud3.png\" title=\"添加ceph rgw\"><br>填写ceph rgw的server和port，access_key,secret_key,enable path style</p>\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud4.png\" title=\"找到对应的文件夹\">\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud5.png\" title=\"上传文件\">\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud6.png\" title=\"在Ceph rgw中查看文件\">\n","site":{"data":{}},"excerpt":"","more":"<p>nextcloud是一个私有网盘解决方案，支持多种后端存储解决方案。<br>nextcloud也支持aws的s3, 而ceph的radosgw也是兼容s3协议的，所以nextcloud也可以使用ceph作为后端存储，具体的配置如下<br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud1.png\" title=\"找到插件\"><br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud2.png\" title=\"enable插件\"><br><img src=\"/2017/08/09/nextcloud-ceph/nextcloud3.png\" title=\"添加ceph rgw\"><br>填写ceph rgw的server和port，access_key,secret_key,enable path style</p>\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud4.png\" title=\"找到对应的文件夹\">\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud5.png\" title=\"上传文件\">\n<img src=\"/2017/08/09/nextcloud-ceph/nextcloud6.png\" title=\"在Ceph rgw中查看文件\">\n"},{"title":"通过pacemaker管理mysql","date":"2018-03-05T09:59:24.000Z","_content":"\n在上一篇blog中[mysql-replication](https://yanyixing.github.io/2018/03/02/mysql-replication/)介绍了如何配置mysql(mariadb)主从复制。我们还可以添加从节点到主节点的复制关系，这样就达到了mysql(mariadb)双向复制。\n\n下面的配置通过pacemaker管理一个双向复制的mysql(mariadb)和一个VIP来实现mysql(mariadb)在双节点上的高可用。\n\n## 环境\n\nOS: CentOS Linux release 7.3.1611 (Core)\n\nDB: mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1\n\nhost1(master): 172.16.143.171\n\nhost2(slave): 172.16.143.172\n\n\n## 安装\n\n\n```bash\nyum install -y mariadb-server\n```\n\n安装完成后可以按照上一篇blog来配置双向复制。\n\n\n```bash\nsystemctl stop mariadb\n\nsystemctl disable mariadb\n```\n\n安装配置pacemaker\n\n```bash\nyum install pcs pacemaker corosync fence-angets-all resource-angets -y\n\nsystemctl start pcsd\n\nsystemctl enable pcsd\n\nsystemctl start pacemaker\n\nsystemctl enable pacemaker\n\nsystemctl start corosync\n\nsystemctl enable corosync\n\npasswd hacluster\n\npcs cluster auth ceph01 ceph02\n\npcs cluster setup --start --name cluster_mysql ceph01 ceph02\n\npcs cluster start --all\n\npcs property set stonith-enabled=false\n\npcs property set no-quorum-policy=ignore\n```\n\n## 配置资源\n\n```bash\npcs resource create virtual_ip ocf:heartbeat:IPaddr2 \\\nip=172.16.143.200 cidr_netmask=24 nic=eth0 op monitor interval=30s on-fail=restart\n\npcs resource create mysql ocf:heartbeat:mysql  \\\nbinary=\"/usr/bin/mysqld_safe\"   config=\"/etc/my.cnf\" \\\n  datadir=\"/var/lib/mysql\"   pid=\"/var/lib/mysql/mysql.pid\" \\\n  socket=\"/var/lib/mysql/mysql.sock\"  \\\n additional_parameters=\"--bind-address=0.0.0.0\"   op start timeout=60s \\\n  op stop timeout=60s   op monitor interval=20s timeout=30s \\\non-fail=standby\n\npcs resource clone mysql clone-max=2 clone-node-max=1\n```\n\n## 结果\n\n```bash\n[root@ceph01 ~]# pcs status\nCluster name: cluster_mysql\nStack: corosync\nCurrent DC: ceph01 (version 1.1.16-12.el7_4.7-94ff4df) - partition with quorum\nLast updated: Mon Mar  5 22:07:52 2018\nLast change: Mon Mar  5 22:06:22 2018 by root via cibadmin on cephlcm\n\n2 nodes configured\n3 resources configured\n\nOnline: [ ceph01 ceph02 ]\n\nFull list of resources:\n\n vip\t(ocf::heartbeat:IPaddr2):\tStarted ceph01\n Clone Set: mysql-clone [mysql]\n     Started: [ ceph01 ceph02 ]\n\nDaemon Status:\n  corosync: active/enabled\n  pacemaker: active/enabled\n  pcsd: active/enabled\n```\n\n","source":"_posts/pacemaker-mysql.md","raw":"---\ntitle: 通过pacemaker管理mysql\ndate: 2018-03-05 17:59:24\ntags: ['linux','mysql','ha']\n---\n\n在上一篇blog中[mysql-replication](https://yanyixing.github.io/2018/03/02/mysql-replication/)介绍了如何配置mysql(mariadb)主从复制。我们还可以添加从节点到主节点的复制关系，这样就达到了mysql(mariadb)双向复制。\n\n下面的配置通过pacemaker管理一个双向复制的mysql(mariadb)和一个VIP来实现mysql(mariadb)在双节点上的高可用。\n\n## 环境\n\nOS: CentOS Linux release 7.3.1611 (Core)\n\nDB: mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1\n\nhost1(master): 172.16.143.171\n\nhost2(slave): 172.16.143.172\n\n\n## 安装\n\n\n```bash\nyum install -y mariadb-server\n```\n\n安装完成后可以按照上一篇blog来配置双向复制。\n\n\n```bash\nsystemctl stop mariadb\n\nsystemctl disable mariadb\n```\n\n安装配置pacemaker\n\n```bash\nyum install pcs pacemaker corosync fence-angets-all resource-angets -y\n\nsystemctl start pcsd\n\nsystemctl enable pcsd\n\nsystemctl start pacemaker\n\nsystemctl enable pacemaker\n\nsystemctl start corosync\n\nsystemctl enable corosync\n\npasswd hacluster\n\npcs cluster auth ceph01 ceph02\n\npcs cluster setup --start --name cluster_mysql ceph01 ceph02\n\npcs cluster start --all\n\npcs property set stonith-enabled=false\n\npcs property set no-quorum-policy=ignore\n```\n\n## 配置资源\n\n```bash\npcs resource create virtual_ip ocf:heartbeat:IPaddr2 \\\nip=172.16.143.200 cidr_netmask=24 nic=eth0 op monitor interval=30s on-fail=restart\n\npcs resource create mysql ocf:heartbeat:mysql  \\\nbinary=\"/usr/bin/mysqld_safe\"   config=\"/etc/my.cnf\" \\\n  datadir=\"/var/lib/mysql\"   pid=\"/var/lib/mysql/mysql.pid\" \\\n  socket=\"/var/lib/mysql/mysql.sock\"  \\\n additional_parameters=\"--bind-address=0.0.0.0\"   op start timeout=60s \\\n  op stop timeout=60s   op monitor interval=20s timeout=30s \\\non-fail=standby\n\npcs resource clone mysql clone-max=2 clone-node-max=1\n```\n\n## 结果\n\n```bash\n[root@ceph01 ~]# pcs status\nCluster name: cluster_mysql\nStack: corosync\nCurrent DC: ceph01 (version 1.1.16-12.el7_4.7-94ff4df) - partition with quorum\nLast updated: Mon Mar  5 22:07:52 2018\nLast change: Mon Mar  5 22:06:22 2018 by root via cibadmin on cephlcm\n\n2 nodes configured\n3 resources configured\n\nOnline: [ ceph01 ceph02 ]\n\nFull list of resources:\n\n vip\t(ocf::heartbeat:IPaddr2):\tStarted ceph01\n Clone Set: mysql-clone [mysql]\n     Started: [ ceph01 ceph02 ]\n\nDaemon Status:\n  corosync: active/enabled\n  pacemaker: active/enabled\n  pcsd: active/enabled\n```\n\n","slug":"pacemaker-mysql","published":1,"updated":"2018-09-26T03:47:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i270008uhv550z0d8w6","content":"<p>在上一篇blog中<a href=\"https://yanyixing.github.io/2018/03/02/mysql-replication/\">mysql-replication</a>介绍了如何配置mysql(mariadb)主从复制。我们还可以添加从节点到主节点的复制关系，这样就达到了mysql(mariadb)双向复制。</p>\n<p>下面的配置通过pacemaker管理一个双向复制的mysql(mariadb)和一个VIP来实现mysql(mariadb)在双节点上的高可用。</p>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS: CentOS Linux release 7.3.1611 (Core)</p>\n<p>DB: mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1</p>\n<p>host1(master): 172.16.143.171</p>\n<p>host2(slave): 172.16.143.172</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y mariadb-server</span><br></pre></td></tr></table></figure>\n<p>安装完成后可以按照上一篇blog来配置双向复制。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop mariadb</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">disable</span> mariadb</span><br></pre></td></tr></table></figure>\n<p>安装配置pacemaker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install pcs pacemaker corosync fence-angets-all resource-angets -y</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start pcsd</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> pcsd</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start pacemaker</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> pacemaker</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start corosync</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> corosync</span><br><span class=\"line\"></span><br><span class=\"line\">passwd hacluster</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster auth ceph01 ceph02</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster setup --start --name cluster_mysql ceph01 ceph02</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster start --all</span><br><span class=\"line\"></span><br><span class=\"line\">pcs property <span class=\"built_in\">set</span> stonith-enabled=<span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\">pcs property <span class=\"built_in\">set</span> no-quorum-policy=ignore</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置资源\"><a href=\"#配置资源\" class=\"headerlink\" title=\"配置资源\"></a>配置资源</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pcs resource create virtual_ip ocf:heartbeat:IPaddr2 \\</span><br><span class=\"line\">ip=172.16.143.200 cidr_netmask=24 nic=eth0 op monitor interval=30s on-fail=restart</span><br><span class=\"line\"></span><br><span class=\"line\">pcs resource create mysql ocf:heartbeat:mysql  \\</span><br><span class=\"line\">binary=<span class=\"string\">\"/usr/bin/mysqld_safe\"</span>   config=<span class=\"string\">\"/etc/my.cnf\"</span> \\</span><br><span class=\"line\">  datadir=<span class=\"string\">\"/var/lib/mysql\"</span>   pid=<span class=\"string\">\"/var/lib/mysql/mysql.pid\"</span> \\</span><br><span class=\"line\">  socket=<span class=\"string\">\"/var/lib/mysql/mysql.sock\"</span>  \\</span><br><span class=\"line\"> additional_parameters=<span class=\"string\">\"--bind-address=0.0.0.0\"</span>   op start timeout=60s \\</span><br><span class=\"line\">  op stop timeout=60s   op monitor interval=20s timeout=30s \\</span><br><span class=\"line\">on-fail=standby</span><br><span class=\"line\"></span><br><span class=\"line\">pcs resource <span class=\"built_in\">clone</span> mysql <span class=\"built_in\">clone</span>-max=2 <span class=\"built_in\">clone</span>-node-max=1</span><br></pre></td></tr></table></figure>\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph01 ~]<span class=\"comment\"># pcs status</span></span><br><span class=\"line\">Cluster name: cluster_mysql</span><br><span class=\"line\">Stack: corosync</span><br><span class=\"line\">Current DC: ceph01 (version 1.1.16-12.el7_4.7-94ff4df) - partition with quorum</span><br><span class=\"line\">Last updated: Mon Mar  5 22:07:52 2018</span><br><span class=\"line\">Last change: Mon Mar  5 22:06:22 2018 by root via cibadmin on cephlcm</span><br><span class=\"line\"></span><br><span class=\"line\">2 nodes configured</span><br><span class=\"line\">3 resources configured</span><br><span class=\"line\"></span><br><span class=\"line\">Online: [ ceph01 ceph02 ]</span><br><span class=\"line\"></span><br><span class=\"line\">Full list of resources:</span><br><span class=\"line\"></span><br><span class=\"line\"> vip\t(ocf::heartbeat:IPaddr2):\tStarted ceph01</span><br><span class=\"line\"> Clone Set: mysql-clone [mysql]</span><br><span class=\"line\">     Started: [ ceph01 ceph02 ]</span><br><span class=\"line\"></span><br><span class=\"line\">Daemon Status:</span><br><span class=\"line\">  corosync: active/enabled</span><br><span class=\"line\">  pacemaker: active/enabled</span><br><span class=\"line\">  pcsd: active/enabled</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>在上一篇blog中<a href=\"https://yanyixing.github.io/2018/03/02/mysql-replication/\">mysql-replication</a>介绍了如何配置mysql(mariadb)主从复制。我们还可以添加从节点到主节点的复制关系，这样就达到了mysql(mariadb)双向复制。</p>\n<p>下面的配置通过pacemaker管理一个双向复制的mysql(mariadb)和一个VIP来实现mysql(mariadb)在双节点上的高可用。</p>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><p>OS: CentOS Linux release 7.3.1611 (Core)</p>\n<p>DB: mysql  Ver 15.1 Distrib 5.5.56-MariaDB, for Linux (x86_64) using readline 5.1</p>\n<p>host1(master): 172.16.143.171</p>\n<p>host2(slave): 172.16.143.172</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y mariadb-server</span><br></pre></td></tr></table></figure>\n<p>安装完成后可以按照上一篇blog来配置双向复制。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop mariadb</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">disable</span> mariadb</span><br></pre></td></tr></table></figure>\n<p>安装配置pacemaker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install pcs pacemaker corosync fence-angets-all resource-angets -y</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start pcsd</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> pcsd</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start pacemaker</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> pacemaker</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start corosync</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> corosync</span><br><span class=\"line\"></span><br><span class=\"line\">passwd hacluster</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster auth ceph01 ceph02</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster setup --start --name cluster_mysql ceph01 ceph02</span><br><span class=\"line\"></span><br><span class=\"line\">pcs cluster start --all</span><br><span class=\"line\"></span><br><span class=\"line\">pcs property <span class=\"built_in\">set</span> stonith-enabled=<span class=\"literal\">false</span></span><br><span class=\"line\"></span><br><span class=\"line\">pcs property <span class=\"built_in\">set</span> no-quorum-policy=ignore</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置资源\"><a href=\"#配置资源\" class=\"headerlink\" title=\"配置资源\"></a>配置资源</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pcs resource create virtual_ip ocf:heartbeat:IPaddr2 \\</span><br><span class=\"line\">ip=172.16.143.200 cidr_netmask=24 nic=eth0 op monitor interval=30s on-fail=restart</span><br><span class=\"line\"></span><br><span class=\"line\">pcs resource create mysql ocf:heartbeat:mysql  \\</span><br><span class=\"line\">binary=<span class=\"string\">\"/usr/bin/mysqld_safe\"</span>   config=<span class=\"string\">\"/etc/my.cnf\"</span> \\</span><br><span class=\"line\">  datadir=<span class=\"string\">\"/var/lib/mysql\"</span>   pid=<span class=\"string\">\"/var/lib/mysql/mysql.pid\"</span> \\</span><br><span class=\"line\">  socket=<span class=\"string\">\"/var/lib/mysql/mysql.sock\"</span>  \\</span><br><span class=\"line\"> additional_parameters=<span class=\"string\">\"--bind-address=0.0.0.0\"</span>   op start timeout=60s \\</span><br><span class=\"line\">  op stop timeout=60s   op monitor interval=20s timeout=30s \\</span><br><span class=\"line\">on-fail=standby</span><br><span class=\"line\"></span><br><span class=\"line\">pcs resource <span class=\"built_in\">clone</span> mysql <span class=\"built_in\">clone</span>-max=2 <span class=\"built_in\">clone</span>-node-max=1</span><br></pre></td></tr></table></figure>\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph01 ~]<span class=\"comment\"># pcs status</span></span><br><span class=\"line\">Cluster name: cluster_mysql</span><br><span class=\"line\">Stack: corosync</span><br><span class=\"line\">Current DC: ceph01 (version 1.1.16-12.el7_4.7-94ff4df) - partition with quorum</span><br><span class=\"line\">Last updated: Mon Mar  5 22:07:52 2018</span><br><span class=\"line\">Last change: Mon Mar  5 22:06:22 2018 by root via cibadmin on cephlcm</span><br><span class=\"line\"></span><br><span class=\"line\">2 nodes configured</span><br><span class=\"line\">3 resources configured</span><br><span class=\"line\"></span><br><span class=\"line\">Online: [ ceph01 ceph02 ]</span><br><span class=\"line\"></span><br><span class=\"line\">Full list of resources:</span><br><span class=\"line\"></span><br><span class=\"line\"> vip\t(ocf::heartbeat:IPaddr2):\tStarted ceph01</span><br><span class=\"line\"> Clone Set: mysql-clone [mysql]</span><br><span class=\"line\">     Started: [ ceph01 ceph02 ]</span><br><span class=\"line\"></span><br><span class=\"line\">Daemon Status:</span><br><span class=\"line\">  corosync: active/enabled</span><br><span class=\"line\">  pacemaker: active/enabled</span><br><span class=\"line\">  pcsd: active/enabled</span><br></pre></td></tr></table></figure>\n"},{"title":"Redis持久化","date":"2018-09-23T09:36:22.000Z","_content":"## 概述\nRedis是一种内存型的数据库，一般都是作为缓存使用，数据都是保存在内存中，但为了防止宕机后数据丢失，Redis提供了两种持久化方案，分别是RDB和AOF。接下来介绍一下这两种持久化方案。\n\n## RDB持久化\nRDB持久化可以把当前Redis内存中的状态保存到硬盘上，可以手动触发，也可以通过配置文件自动执行。\n\nRDB持久化后的文件是一个经过压缩的二进制文件，redis可以通过这个文件进行数据还原。\n\nRDB持久化可以通过下面两个命令来触发：\n\n* SAVE: 阻塞Redis进程，知道RDB文件创建完成\n* BGSAVE: fork一个子进程来创建RDB文件，\n\n### RDB持久化优点\n1. 一旦采用该方式，那么你的整个Redis数据库将只包含一个文件，这对于文件备份而言是非常完美的。比如，你可能打算每个小时归档一次最近24小时的数据，同时还要每天归档一次最近30天的数据。通过这样的备份策略，一旦系统出现灾难性故障，我们可以非常容易的进行恢复。\n2. 对于灾难恢复而言，RDB是非常不错的选择。因为我们可以非常轻松的将一个单独的文件压缩后再转移到其它存储介质上。\n3. 性能最大化。对于Redis的服务进程而言，在开始持久化时，它唯一需要做的只是fork出子进程，之后再由子进程完成这些持久化的工作，这样就可以极大的避免服务进程执行IO操作了。\n4. 相比于AOF机制，如果数据集很大，RDB的启动效率会更高。\n\n### RDB持久化缺点\n1. 如果你想保证数据的高可用性，即最大限度的避免数据丢失，那么RDB将不是一个很好的选择。因为系统一旦在定时持久化之前出现宕机现象，此前没有来得及写入磁盘的数据都将丢失。\n2. 由于RDB是通过fork子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫秒，甚至是1秒钟。\n\n## AOF持久化\n\nAOF持久化（Append-Only-File），与RDB持久化不同，AOF持久化是通过保存Redis服务器所执行的写状态来记录数据库的。\n\n具体来说，RDB持久化相当于备份数据库状态，而AOF持久化是备份数据库接收到的命令，所有被写入AOF的命令都是以redis的协议格式来保存的。\n\n在AOF持久化的文件中，数据库会记录下所有变更数据库状态的命令，除了指定数据库的select命令，其他的命令都是来自client的，这些命令会以追加(append)的形式保存到文件中。\n\n服务器配置中有一项appendfsync，这个配置会影响服务器多久完成一次命令的记录：\n\n* always：将缓存区的内容总是即时写到AOF文件中。\n* everysec：将缓存区的内容每隔一秒写入AOF文件中。\n* no ：写入AOF文件中的操作由操作系统决定，一般而言为了提高效率，操作系统会等待缓存区被填满，才会开始同步数据到磁盘。\n\nredis默认实用的是everysec。\n\nredis在载入AOF文件的时候，会创建一个虚拟的client，把AOF中每一条命令都执行一遍，最终还原回数据库的状态，它的载入也是自动的。在RDB和AOF备份文件都有的情况下，redis会优先载入AOF备份文件。\n\nAOF文件可能会随着服务器运行的时间越来越大，可以利用AOF重写的功能，来控制AOF文件的大小。AOF重写功能会首先读取数据库中现有的键值对状态，然后根据类型使用一条命令来替代前的键值对多条命令。\n\nAOF重写功能有大量写入操作，所以redis才用子进程来处理AOF重写。这里带来一个新的问题，由于处理重新的是子进程，这样意味着如果主线程的数据在此时被修改，备份的数据和主库的数据将会有不一致的情况发生。因此redis还设置了一个AOF重写缓冲区，这个缓冲区在子进程被创建开始之后开始使用，这个期间，所有的命令会被存两份，一份在AOF缓存空间，一份在AOF重写缓冲区，当AOF重写完成之后，子进程发送信号给主进程，通知主进程将AOF重写缓冲区的内容添加到AOF文件中。\n\n### AOF的优点\n1. 该机制可以带来更高的数据安全性，即数据持久性。Redis中提供了3中同步策略，即everysec、always和no。事实上，everysec也是异步完成的，其效率也是非常高的，所差的是一旦系统出现宕机现象，那么这一秒钟之内修改的数据将会丢失。而always，我们可以将其视为同步持久化，即每次发生的数据变化都会被立即记录到磁盘中。可以预见，这种方式在效率上是最低的。至于no，无需多言，我想大家都能正确的理解它。\n2. 由于该机制对日志文件的写入操作采用的是append模式，因此在写入过程中即使出现宕机现象，也不会破坏日志文件中已经存在的内容。然而如果我们本次操作只是写入了一半数据就出现了系统崩溃问题，不用担心，在Redis下一次启动之前，我们可以通过redis-check-aof工具来帮助我们解决数据一致性的问题。\n3. 如果日志过大，Redis可以自动启用rewrite机制。即Redis以append模式不断的将修改数据写入到老的磁盘文件中，同时Redis还会创建一个新的文件用于记录此期间有哪些修改命令被执行。因此在进行rewrite切换时可以更好的保证数据安全性。\n4. AOF包含一个格式清晰、易于理解的日志文件用于记录所有的修改操作。事实上，我们也可以通过该文件完成数据的重建。\n\n### AOF的缺点\n1. 对于相同数量的数据集而言，AOF文件通常要大于RDB文件。RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。\n2. 根据同步策略的不同，AOF在运行效率上往往会慢于RDB。总之，每秒同步策略的效率是比较高的，no策略的效率和RDB一样高效。","source":"_posts/redis-persistence.md","raw":"---\ntitle: Redis持久化\ndate: 2018-09-23 17:36:22\ntags: ['redis']\n---\n## 概述\nRedis是一种内存型的数据库，一般都是作为缓存使用，数据都是保存在内存中，但为了防止宕机后数据丢失，Redis提供了两种持久化方案，分别是RDB和AOF。接下来介绍一下这两种持久化方案。\n\n## RDB持久化\nRDB持久化可以把当前Redis内存中的状态保存到硬盘上，可以手动触发，也可以通过配置文件自动执行。\n\nRDB持久化后的文件是一个经过压缩的二进制文件，redis可以通过这个文件进行数据还原。\n\nRDB持久化可以通过下面两个命令来触发：\n\n* SAVE: 阻塞Redis进程，知道RDB文件创建完成\n* BGSAVE: fork一个子进程来创建RDB文件，\n\n### RDB持久化优点\n1. 一旦采用该方式，那么你的整个Redis数据库将只包含一个文件，这对于文件备份而言是非常完美的。比如，你可能打算每个小时归档一次最近24小时的数据，同时还要每天归档一次最近30天的数据。通过这样的备份策略，一旦系统出现灾难性故障，我们可以非常容易的进行恢复。\n2. 对于灾难恢复而言，RDB是非常不错的选择。因为我们可以非常轻松的将一个单独的文件压缩后再转移到其它存储介质上。\n3. 性能最大化。对于Redis的服务进程而言，在开始持久化时，它唯一需要做的只是fork出子进程，之后再由子进程完成这些持久化的工作，这样就可以极大的避免服务进程执行IO操作了。\n4. 相比于AOF机制，如果数据集很大，RDB的启动效率会更高。\n\n### RDB持久化缺点\n1. 如果你想保证数据的高可用性，即最大限度的避免数据丢失，那么RDB将不是一个很好的选择。因为系统一旦在定时持久化之前出现宕机现象，此前没有来得及写入磁盘的数据都将丢失。\n2. 由于RDB是通过fork子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫秒，甚至是1秒钟。\n\n## AOF持久化\n\nAOF持久化（Append-Only-File），与RDB持久化不同，AOF持久化是通过保存Redis服务器所执行的写状态来记录数据库的。\n\n具体来说，RDB持久化相当于备份数据库状态，而AOF持久化是备份数据库接收到的命令，所有被写入AOF的命令都是以redis的协议格式来保存的。\n\n在AOF持久化的文件中，数据库会记录下所有变更数据库状态的命令，除了指定数据库的select命令，其他的命令都是来自client的，这些命令会以追加(append)的形式保存到文件中。\n\n服务器配置中有一项appendfsync，这个配置会影响服务器多久完成一次命令的记录：\n\n* always：将缓存区的内容总是即时写到AOF文件中。\n* everysec：将缓存区的内容每隔一秒写入AOF文件中。\n* no ：写入AOF文件中的操作由操作系统决定，一般而言为了提高效率，操作系统会等待缓存区被填满，才会开始同步数据到磁盘。\n\nredis默认实用的是everysec。\n\nredis在载入AOF文件的时候，会创建一个虚拟的client，把AOF中每一条命令都执行一遍，最终还原回数据库的状态，它的载入也是自动的。在RDB和AOF备份文件都有的情况下，redis会优先载入AOF备份文件。\n\nAOF文件可能会随着服务器运行的时间越来越大，可以利用AOF重写的功能，来控制AOF文件的大小。AOF重写功能会首先读取数据库中现有的键值对状态，然后根据类型使用一条命令来替代前的键值对多条命令。\n\nAOF重写功能有大量写入操作，所以redis才用子进程来处理AOF重写。这里带来一个新的问题，由于处理重新的是子进程，这样意味着如果主线程的数据在此时被修改，备份的数据和主库的数据将会有不一致的情况发生。因此redis还设置了一个AOF重写缓冲区，这个缓冲区在子进程被创建开始之后开始使用，这个期间，所有的命令会被存两份，一份在AOF缓存空间，一份在AOF重写缓冲区，当AOF重写完成之后，子进程发送信号给主进程，通知主进程将AOF重写缓冲区的内容添加到AOF文件中。\n\n### AOF的优点\n1. 该机制可以带来更高的数据安全性，即数据持久性。Redis中提供了3中同步策略，即everysec、always和no。事实上，everysec也是异步完成的，其效率也是非常高的，所差的是一旦系统出现宕机现象，那么这一秒钟之内修改的数据将会丢失。而always，我们可以将其视为同步持久化，即每次发生的数据变化都会被立即记录到磁盘中。可以预见，这种方式在效率上是最低的。至于no，无需多言，我想大家都能正确的理解它。\n2. 由于该机制对日志文件的写入操作采用的是append模式，因此在写入过程中即使出现宕机现象，也不会破坏日志文件中已经存在的内容。然而如果我们本次操作只是写入了一半数据就出现了系统崩溃问题，不用担心，在Redis下一次启动之前，我们可以通过redis-check-aof工具来帮助我们解决数据一致性的问题。\n3. 如果日志过大，Redis可以自动启用rewrite机制。即Redis以append模式不断的将修改数据写入到老的磁盘文件中，同时Redis还会创建一个新的文件用于记录此期间有哪些修改命令被执行。因此在进行rewrite切换时可以更好的保证数据安全性。\n4. AOF包含一个格式清晰、易于理解的日志文件用于记录所有的修改操作。事实上，我们也可以通过该文件完成数据的重建。\n\n### AOF的缺点\n1. 对于相同数量的数据集而言，AOF文件通常要大于RDB文件。RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。\n2. 根据同步策略的不同，AOF在运行效率上往往会慢于RDB。总之，每秒同步策略的效率是比较高的，no策略的效率和RDB一样高效。","slug":"redis-persistence","published":1,"updated":"2018-09-23T14:12:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2a000buhv5v8muxmxv","content":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>Redis是一种内存型的数据库，一般都是作为缓存使用，数据都是保存在内存中，但为了防止宕机后数据丢失，Redis提供了两种持久化方案，分别是RDB和AOF。接下来介绍一下这两种持久化方案。</p>\n<h2 id=\"RDB持久化\"><a href=\"#RDB持久化\" class=\"headerlink\" title=\"RDB持久化\"></a>RDB持久化</h2><p>RDB持久化可以把当前Redis内存中的状态保存到硬盘上，可以手动触发，也可以通过配置文件自动执行。</p>\n<p>RDB持久化后的文件是一个经过压缩的二进制文件，redis可以通过这个文件进行数据还原。</p>\n<p>RDB持久化可以通过下面两个命令来触发：</p>\n<ul>\n<li>SAVE: 阻塞Redis进程，知道RDB文件创建完成</li>\n<li>BGSAVE: fork一个子进程来创建RDB文件，</li>\n</ul>\n<h3 id=\"RDB持久化优点\"><a href=\"#RDB持久化优点\" class=\"headerlink\" title=\"RDB持久化优点\"></a>RDB持久化优点</h3><ol>\n<li>一旦采用该方式，那么你的整个Redis数据库将只包含一个文件，这对于文件备份而言是非常完美的。比如，你可能打算每个小时归档一次最近24小时的数据，同时还要每天归档一次最近30天的数据。通过这样的备份策略，一旦系统出现灾难性故障，我们可以非常容易的进行恢复。</li>\n<li>对于灾难恢复而言，RDB是非常不错的选择。因为我们可以非常轻松的将一个单独的文件压缩后再转移到其它存储介质上。</li>\n<li>性能最大化。对于Redis的服务进程而言，在开始持久化时，它唯一需要做的只是fork出子进程，之后再由子进程完成这些持久化的工作，这样就可以极大的避免服务进程执行IO操作了。</li>\n<li>相比于AOF机制，如果数据集很大，RDB的启动效率会更高。</li>\n</ol>\n<h3 id=\"RDB持久化缺点\"><a href=\"#RDB持久化缺点\" class=\"headerlink\" title=\"RDB持久化缺点\"></a>RDB持久化缺点</h3><ol>\n<li>如果你想保证数据的高可用性，即最大限度的避免数据丢失，那么RDB将不是一个很好的选择。因为系统一旦在定时持久化之前出现宕机现象，此前没有来得及写入磁盘的数据都将丢失。</li>\n<li>由于RDB是通过fork子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫秒，甚至是1秒钟。</li>\n</ol>\n<h2 id=\"AOF持久化\"><a href=\"#AOF持久化\" class=\"headerlink\" title=\"AOF持久化\"></a>AOF持久化</h2><p>AOF持久化（Append-Only-File），与RDB持久化不同，AOF持久化是通过保存Redis服务器所执行的写状态来记录数据库的。</p>\n<p>具体来说，RDB持久化相当于备份数据库状态，而AOF持久化是备份数据库接收到的命令，所有被写入AOF的命令都是以redis的协议格式来保存的。</p>\n<p>在AOF持久化的文件中，数据库会记录下所有变更数据库状态的命令，除了指定数据库的select命令，其他的命令都是来自client的，这些命令会以追加(append)的形式保存到文件中。</p>\n<p>服务器配置中有一项appendfsync，这个配置会影响服务器多久完成一次命令的记录：</p>\n<ul>\n<li>always：将缓存区的内容总是即时写到AOF文件中。</li>\n<li>everysec：将缓存区的内容每隔一秒写入AOF文件中。</li>\n<li>no ：写入AOF文件中的操作由操作系统决定，一般而言为了提高效率，操作系统会等待缓存区被填满，才会开始同步数据到磁盘。</li>\n</ul>\n<p>redis默认实用的是everysec。</p>\n<p>redis在载入AOF文件的时候，会创建一个虚拟的client，把AOF中每一条命令都执行一遍，最终还原回数据库的状态，它的载入也是自动的。在RDB和AOF备份文件都有的情况下，redis会优先载入AOF备份文件。</p>\n<p>AOF文件可能会随着服务器运行的时间越来越大，可以利用AOF重写的功能，来控制AOF文件的大小。AOF重写功能会首先读取数据库中现有的键值对状态，然后根据类型使用一条命令来替代前的键值对多条命令。</p>\n<p>AOF重写功能有大量写入操作，所以redis才用子进程来处理AOF重写。这里带来一个新的问题，由于处理重新的是子进程，这样意味着如果主线程的数据在此时被修改，备份的数据和主库的数据将会有不一致的情况发生。因此redis还设置了一个AOF重写缓冲区，这个缓冲区在子进程被创建开始之后开始使用，这个期间，所有的命令会被存两份，一份在AOF缓存空间，一份在AOF重写缓冲区，当AOF重写完成之后，子进程发送信号给主进程，通知主进程将AOF重写缓冲区的内容添加到AOF文件中。</p>\n<h3 id=\"AOF的优点\"><a href=\"#AOF的优点\" class=\"headerlink\" title=\"AOF的优点\"></a>AOF的优点</h3><ol>\n<li>该机制可以带来更高的数据安全性，即数据持久性。Redis中提供了3中同步策略，即everysec、always和no。事实上，everysec也是异步完成的，其效率也是非常高的，所差的是一旦系统出现宕机现象，那么这一秒钟之内修改的数据将会丢失。而always，我们可以将其视为同步持久化，即每次发生的数据变化都会被立即记录到磁盘中。可以预见，这种方式在效率上是最低的。至于no，无需多言，我想大家都能正确的理解它。</li>\n<li>由于该机制对日志文件的写入操作采用的是append模式，因此在写入过程中即使出现宕机现象，也不会破坏日志文件中已经存在的内容。然而如果我们本次操作只是写入了一半数据就出现了系统崩溃问题，不用担心，在Redis下一次启动之前，我们可以通过redis-check-aof工具来帮助我们解决数据一致性的问题。</li>\n<li>如果日志过大，Redis可以自动启用rewrite机制。即Redis以append模式不断的将修改数据写入到老的磁盘文件中，同时Redis还会创建一个新的文件用于记录此期间有哪些修改命令被执行。因此在进行rewrite切换时可以更好的保证数据安全性。</li>\n<li>AOF包含一个格式清晰、易于理解的日志文件用于记录所有的修改操作。事实上，我们也可以通过该文件完成数据的重建。</li>\n</ol>\n<h3 id=\"AOF的缺点\"><a href=\"#AOF的缺点\" class=\"headerlink\" title=\"AOF的缺点\"></a>AOF的缺点</h3><ol>\n<li>对于相同数量的数据集而言，AOF文件通常要大于RDB文件。RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。</li>\n<li>根据同步策略的不同，AOF在运行效率上往往会慢于RDB。总之，每秒同步策略的效率是比较高的，no策略的效率和RDB一样高效。</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>Redis是一种内存型的数据库，一般都是作为缓存使用，数据都是保存在内存中，但为了防止宕机后数据丢失，Redis提供了两种持久化方案，分别是RDB和AOF。接下来介绍一下这两种持久化方案。</p>\n<h2 id=\"RDB持久化\"><a href=\"#RDB持久化\" class=\"headerlink\" title=\"RDB持久化\"></a>RDB持久化</h2><p>RDB持久化可以把当前Redis内存中的状态保存到硬盘上，可以手动触发，也可以通过配置文件自动执行。</p>\n<p>RDB持久化后的文件是一个经过压缩的二进制文件，redis可以通过这个文件进行数据还原。</p>\n<p>RDB持久化可以通过下面两个命令来触发：</p>\n<ul>\n<li>SAVE: 阻塞Redis进程，知道RDB文件创建完成</li>\n<li>BGSAVE: fork一个子进程来创建RDB文件，</li>\n</ul>\n<h3 id=\"RDB持久化优点\"><a href=\"#RDB持久化优点\" class=\"headerlink\" title=\"RDB持久化优点\"></a>RDB持久化优点</h3><ol>\n<li>一旦采用该方式，那么你的整个Redis数据库将只包含一个文件，这对于文件备份而言是非常完美的。比如，你可能打算每个小时归档一次最近24小时的数据，同时还要每天归档一次最近30天的数据。通过这样的备份策略，一旦系统出现灾难性故障，我们可以非常容易的进行恢复。</li>\n<li>对于灾难恢复而言，RDB是非常不错的选择。因为我们可以非常轻松的将一个单独的文件压缩后再转移到其它存储介质上。</li>\n<li>性能最大化。对于Redis的服务进程而言，在开始持久化时，它唯一需要做的只是fork出子进程，之后再由子进程完成这些持久化的工作，这样就可以极大的避免服务进程执行IO操作了。</li>\n<li>相比于AOF机制，如果数据集很大，RDB的启动效率会更高。</li>\n</ol>\n<h3 id=\"RDB持久化缺点\"><a href=\"#RDB持久化缺点\" class=\"headerlink\" title=\"RDB持久化缺点\"></a>RDB持久化缺点</h3><ol>\n<li>如果你想保证数据的高可用性，即最大限度的避免数据丢失，那么RDB将不是一个很好的选择。因为系统一旦在定时持久化之前出现宕机现象，此前没有来得及写入磁盘的数据都将丢失。</li>\n<li>由于RDB是通过fork子进程来协助完成数据持久化工作的，因此，如果当数据集较大时，可能会导致整个服务器停止服务几百毫秒，甚至是1秒钟。</li>\n</ol>\n<h2 id=\"AOF持久化\"><a href=\"#AOF持久化\" class=\"headerlink\" title=\"AOF持久化\"></a>AOF持久化</h2><p>AOF持久化（Append-Only-File），与RDB持久化不同，AOF持久化是通过保存Redis服务器所执行的写状态来记录数据库的。</p>\n<p>具体来说，RDB持久化相当于备份数据库状态，而AOF持久化是备份数据库接收到的命令，所有被写入AOF的命令都是以redis的协议格式来保存的。</p>\n<p>在AOF持久化的文件中，数据库会记录下所有变更数据库状态的命令，除了指定数据库的select命令，其他的命令都是来自client的，这些命令会以追加(append)的形式保存到文件中。</p>\n<p>服务器配置中有一项appendfsync，这个配置会影响服务器多久完成一次命令的记录：</p>\n<ul>\n<li>always：将缓存区的内容总是即时写到AOF文件中。</li>\n<li>everysec：将缓存区的内容每隔一秒写入AOF文件中。</li>\n<li>no ：写入AOF文件中的操作由操作系统决定，一般而言为了提高效率，操作系统会等待缓存区被填满，才会开始同步数据到磁盘。</li>\n</ul>\n<p>redis默认实用的是everysec。</p>\n<p>redis在载入AOF文件的时候，会创建一个虚拟的client，把AOF中每一条命令都执行一遍，最终还原回数据库的状态，它的载入也是自动的。在RDB和AOF备份文件都有的情况下，redis会优先载入AOF备份文件。</p>\n<p>AOF文件可能会随着服务器运行的时间越来越大，可以利用AOF重写的功能，来控制AOF文件的大小。AOF重写功能会首先读取数据库中现有的键值对状态，然后根据类型使用一条命令来替代前的键值对多条命令。</p>\n<p>AOF重写功能有大量写入操作，所以redis才用子进程来处理AOF重写。这里带来一个新的问题，由于处理重新的是子进程，这样意味着如果主线程的数据在此时被修改，备份的数据和主库的数据将会有不一致的情况发生。因此redis还设置了一个AOF重写缓冲区，这个缓冲区在子进程被创建开始之后开始使用，这个期间，所有的命令会被存两份，一份在AOF缓存空间，一份在AOF重写缓冲区，当AOF重写完成之后，子进程发送信号给主进程，通知主进程将AOF重写缓冲区的内容添加到AOF文件中。</p>\n<h3 id=\"AOF的优点\"><a href=\"#AOF的优点\" class=\"headerlink\" title=\"AOF的优点\"></a>AOF的优点</h3><ol>\n<li>该机制可以带来更高的数据安全性，即数据持久性。Redis中提供了3中同步策略，即everysec、always和no。事实上，everysec也是异步完成的，其效率也是非常高的，所差的是一旦系统出现宕机现象，那么这一秒钟之内修改的数据将会丢失。而always，我们可以将其视为同步持久化，即每次发生的数据变化都会被立即记录到磁盘中。可以预见，这种方式在效率上是最低的。至于no，无需多言，我想大家都能正确的理解它。</li>\n<li>由于该机制对日志文件的写入操作采用的是append模式，因此在写入过程中即使出现宕机现象，也不会破坏日志文件中已经存在的内容。然而如果我们本次操作只是写入了一半数据就出现了系统崩溃问题，不用担心，在Redis下一次启动之前，我们可以通过redis-check-aof工具来帮助我们解决数据一致性的问题。</li>\n<li>如果日志过大，Redis可以自动启用rewrite机制。即Redis以append模式不断的将修改数据写入到老的磁盘文件中，同时Redis还会创建一个新的文件用于记录此期间有哪些修改命令被执行。因此在进行rewrite切换时可以更好的保证数据安全性。</li>\n<li>AOF包含一个格式清晰、易于理解的日志文件用于记录所有的修改操作。事实上，我们也可以通过该文件完成数据的重建。</li>\n</ol>\n<h3 id=\"AOF的缺点\"><a href=\"#AOF的缺点\" class=\"headerlink\" title=\"AOF的缺点\"></a>AOF的缺点</h3><ol>\n<li>对于相同数量的数据集而言，AOF文件通常要大于RDB文件。RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。</li>\n<li>根据同步策略的不同，AOF在运行效率上往往会慢于RDB。总之，每秒同步策略的效率是比较高的，no策略的效率和RDB一样高效。</li>\n</ol>\n"},{"title":"reposync","date":"2018-06-12T10:40:40.000Z","_content":"\n在某些环境中，是不能上外网的，这就需要搭建一个内部的yum源，供内网的服务器安装软件。\n\n那如何把公网的yum源下载下来能，这可以通过使用yum-utils工具包来完成\n\n`\nyum install yum-utils -y\n`\n\n安装完成之后就可以使用reposync命令来同步yum源了\n\n通过下面的命令可以查看当前配置的yum源\n\n`\nyum repolist\n`\n\n找到需要同步的yum源，通过下面的命令进行同步\n\n`\nreposync --repoid=<$reponame> --download_path=<$path>\n`\n\n这样就把公网的yum源同步到本地磁盘了，以后就可以通过下载下来的内容搭建内网yum源\n","source":"_posts/reposync.md","raw":"---\ntitle: reposync\ndate: 2018-06-12 18:40:40\ntags: ['linux']\n---\n\n在某些环境中，是不能上外网的，这就需要搭建一个内部的yum源，供内网的服务器安装软件。\n\n那如何把公网的yum源下载下来能，这可以通过使用yum-utils工具包来完成\n\n`\nyum install yum-utils -y\n`\n\n安装完成之后就可以使用reposync命令来同步yum源了\n\n通过下面的命令可以查看当前配置的yum源\n\n`\nyum repolist\n`\n\n找到需要同步的yum源，通过下面的命令进行同步\n\n`\nreposync --repoid=<$reponame> --download_path=<$path>\n`\n\n这样就把公网的yum源同步到本地磁盘了，以后就可以通过下载下来的内容搭建内网yum源\n","slug":"reposync","published":1,"updated":"2018-06-23T07:52:08.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2c000cuhv5en24thfy","content":"<p>在某些环境中，是不能上外网的，这就需要搭建一个内部的yum源，供内网的服务器安装软件。</p>\n<p>那如何把公网的yum源下载下来能，这可以通过使用yum-utils工具包来完成</p>\n<p><code>yum install yum-utils -y</code></p>\n<p>安装完成之后就可以使用reposync命令来同步yum源了</p>\n<p>通过下面的命令可以查看当前配置的yum源</p>\n<p><code>yum repolist</code></p>\n<p>找到需要同步的yum源，通过下面的命令进行同步</p>\n<p><code>reposync --repoid=&lt;$reponame&gt; --download_path=&lt;$path&gt;</code></p>\n<p>这样就把公网的yum源同步到本地磁盘了，以后就可以通过下载下来的内容搭建内网yum源</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在某些环境中，是不能上外网的，这就需要搭建一个内部的yum源，供内网的服务器安装软件。</p>\n<p>那如何把公网的yum源下载下来能，这可以通过使用yum-utils工具包来完成</p>\n<p><code>yum install yum-utils -y</code></p>\n<p>安装完成之后就可以使用reposync命令来同步yum源了</p>\n<p>通过下面的命令可以查看当前配置的yum源</p>\n<p><code>yum repolist</code></p>\n<p>找到需要同步的yum源，通过下面的命令进行同步</p>\n<p><code>reposync --repoid=&lt;$reponame&gt; --download_path=&lt;$path&gt;</code></p>\n<p>这样就把公网的yum源同步到本地磁盘了，以后就可以通过下载下来的内容搭建内网yum源</p>\n"},{"title":"通过mock来构建rpm包","date":"2018-09-25T14:50:54.000Z","_content":"\n## 概述\nmock是一个构建rpm包的工具，你可以使用mock来编译不同系统（CentOS,RedHat和Fedora）版本的rpm包。  \n相比通过rpmbuild来构建rpm包，使用mock通过使用chroot技术，可以在一个干净的环境中来构建rpm包。\n\n## 安装mock\n\n\n```\nyum install epel-release -y\n\nyum install mock -y\n```\n\n需要运行mock的用户都需要添加到mock这个组里，可以通过usermod来把用户添加到mock组。\n\n```\nusermod -a -G mock <user>\n```\n\n## 构建准备\n\n使用mock来构建rpm包，需要要有source rpm。  \n如果有一个spec文件，则可以通过rpmbuild来构建source rpm\n\n```\nrpmbuild -bs xxx.spec\n```\n\n当然，你也可以直接下载source rpm，这样就少了上面的这个步骤。\n\n## 构建RPM包\n\n运行mock命令时，你必须要执行一个配置文件，当前系统上可用的配置文件都在/etc/mock目录下。如下面的内容：\n\n```\n-rw-r--r-- 1 root mock  1595 Aug 16 22:42 epel-5-i386.cfg\n-rw-r--r-- 1 root mock  1585 Aug 16 22:42 epel-5-x86_64.cfg\n-rw-r--r-- 1 root mock  1812 Aug 16 22:42 epel-6-i386.cfg\n-rw-r--r-- 1 root mock  1592 Aug 16 22:42 epel-6-ppc64.cfg\n-rw-r--r-- 1 root mock  2250 Aug 16 22:42 epel-6-x86_64.cfg\n-rw-r--r-- 1 root mock  2362 Aug 16 22:42 epel-7-aarch64.cfg\n-rw-r--r-- 1 root mock  2399 Aug 16 22:42 epel-7-ppc64le.cfg\n-rw-r--r-- 1 root mock  2394 Aug 16 22:42 epel-7-x86_64.cfg\n-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-aarch64.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-25-i386.cfg\n-rw-r--r-- 1 root mock  2014 Aug 16 22:42 fedora-25-ppc64.cfg\n-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-ppc64le.cfg\n-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-25-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-aarch64.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-26-i386.cfg\n-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-26-ppc64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-ppc64le.cfg\n-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-26-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-aarch64.cfg\n-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-27-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-27-i386.cfg\n-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-27-ppc64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-ppc64le.cfg\n-rw-r--r-- 1 root mock  2012 Aug 16 22:42 fedora-27-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-27-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-28-aarch64.cfg\n-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-28-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-28-i386.cfg\n```\n\n### 初始化和删除mock chroot\n\n你可以先初始化mock使用的chroot，这样就可以减少构建rpm包的时间\n\n```\nmock -r epel-7-x86_64 --init\n```\n\n你可以通过下面的命令来删除chroot\n\n```\nmock -r epel-7-x86_64 --clean\n```\n\n### 执行构建\n\n```\nmock -r epel-7-x86_64 --rebuild xxx.src.rpm\n```\n当构建完成，结构和日志都在/var/lib/mock/epel-7-x86_64/result目录下。你可可以通过添加参数 --resultdir来调整目录\n\n## 结论\n\n通过mock可以构建不同架构不同版本下的rpm包，mock可以保证整个过程不受之前的构建的影响，并且提供了一个简单的接口用于重复构建rpm包。\n","source":"_posts/rpm-mock.md","raw":"---\ntitle: 通过mock来构建rpm包\ndate: 2018-09-25 22:50:54\ntags: ['linux']\n---\n\n## 概述\nmock是一个构建rpm包的工具，你可以使用mock来编译不同系统（CentOS,RedHat和Fedora）版本的rpm包。  \n相比通过rpmbuild来构建rpm包，使用mock通过使用chroot技术，可以在一个干净的环境中来构建rpm包。\n\n## 安装mock\n\n\n```\nyum install epel-release -y\n\nyum install mock -y\n```\n\n需要运行mock的用户都需要添加到mock这个组里，可以通过usermod来把用户添加到mock组。\n\n```\nusermod -a -G mock <user>\n```\n\n## 构建准备\n\n使用mock来构建rpm包，需要要有source rpm。  \n如果有一个spec文件，则可以通过rpmbuild来构建source rpm\n\n```\nrpmbuild -bs xxx.spec\n```\n\n当然，你也可以直接下载source rpm，这样就少了上面的这个步骤。\n\n## 构建RPM包\n\n运行mock命令时，你必须要执行一个配置文件，当前系统上可用的配置文件都在/etc/mock目录下。如下面的内容：\n\n```\n-rw-r--r-- 1 root mock  1595 Aug 16 22:42 epel-5-i386.cfg\n-rw-r--r-- 1 root mock  1585 Aug 16 22:42 epel-5-x86_64.cfg\n-rw-r--r-- 1 root mock  1812 Aug 16 22:42 epel-6-i386.cfg\n-rw-r--r-- 1 root mock  1592 Aug 16 22:42 epel-6-ppc64.cfg\n-rw-r--r-- 1 root mock  2250 Aug 16 22:42 epel-6-x86_64.cfg\n-rw-r--r-- 1 root mock  2362 Aug 16 22:42 epel-7-aarch64.cfg\n-rw-r--r-- 1 root mock  2399 Aug 16 22:42 epel-7-ppc64le.cfg\n-rw-r--r-- 1 root mock  2394 Aug 16 22:42 epel-7-x86_64.cfg\n-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-aarch64.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-25-i386.cfg\n-rw-r--r-- 1 root mock  2014 Aug 16 22:42 fedora-25-ppc64.cfg\n-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-ppc64le.cfg\n-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-25-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-aarch64.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-26-i386.cfg\n-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-26-ppc64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-ppc64le.cfg\n-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-26-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-aarch64.cfg\n-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-27-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-27-i386.cfg\n-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-27-ppc64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-ppc64le.cfg\n-rw-r--r-- 1 root mock  2012 Aug 16 22:42 fedora-27-s390x.cfg\n-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-27-x86_64.cfg\n-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-28-aarch64.cfg\n-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-28-armhfp.cfg\n-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-28-i386.cfg\n```\n\n### 初始化和删除mock chroot\n\n你可以先初始化mock使用的chroot，这样就可以减少构建rpm包的时间\n\n```\nmock -r epel-7-x86_64 --init\n```\n\n你可以通过下面的命令来删除chroot\n\n```\nmock -r epel-7-x86_64 --clean\n```\n\n### 执行构建\n\n```\nmock -r epel-7-x86_64 --rebuild xxx.src.rpm\n```\n当构建完成，结构和日志都在/var/lib/mock/epel-7-x86_64/result目录下。你可可以通过添加参数 --resultdir来调整目录\n\n## 结论\n\n通过mock可以构建不同架构不同版本下的rpm包，mock可以保证整个过程不受之前的构建的影响，并且提供了一个简单的接口用于重复构建rpm包。\n","slug":"rpm-mock","published":1,"updated":"2018-09-26T02:44:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2d000euhv5awqty0xk","content":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>mock是一个构建rpm包的工具，你可以使用mock来编译不同系统（CentOS,RedHat和Fedora）版本的rpm包。<br>相比通过rpmbuild来构建rpm包，使用mock通过使用chroot技术，可以在一个干净的环境中来构建rpm包。</p>\n<h2 id=\"安装mock\"><a href=\"#安装mock\" class=\"headerlink\" title=\"安装mock\"></a>安装mock</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install epel-release -y</span><br><span class=\"line\"></span><br><span class=\"line\">yum install mock -y</span><br></pre></td></tr></table></figure>\n<p>需要运行mock的用户都需要添加到mock这个组里，可以通过usermod来把用户添加到mock组。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -a -G mock &lt;user&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"构建准备\"><a href=\"#构建准备\" class=\"headerlink\" title=\"构建准备\"></a>构建准备</h2><p>使用mock来构建rpm包，需要要有source rpm。<br>如果有一个spec文件，则可以通过rpmbuild来构建source rpm</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpmbuild -bs xxx.spec</span><br></pre></td></tr></table></figure>\n<p>当然，你也可以直接下载source rpm，这样就少了上面的这个步骤。</p>\n<h2 id=\"构建RPM包\"><a href=\"#构建RPM包\" class=\"headerlink\" title=\"构建RPM包\"></a>构建RPM包</h2><p>运行mock命令时，你必须要执行一个配置文件，当前系统上可用的配置文件都在/etc/mock目录下。如下面的内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-rw-r--r-- 1 root mock  1595 Aug 16 22:42 epel-5-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1585 Aug 16 22:42 epel-5-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1812 Aug 16 22:42 epel-6-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1592 Aug 16 22:42 epel-6-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2250 Aug 16 22:42 epel-6-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2362 Aug 16 22:42 epel-7-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2399 Aug 16 22:42 epel-7-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2394 Aug 16 22:42 epel-7-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-25-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2014 Aug 16 22:42 fedora-25-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-25-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-26-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-26-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-26-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-27-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-27-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-27-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2012 Aug 16 22:42 fedora-27-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-27-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-28-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-28-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-28-i386.cfg</span><br></pre></td></tr></table></figure>\n<h3 id=\"初始化和删除mock-chroot\"><a href=\"#初始化和删除mock-chroot\" class=\"headerlink\" title=\"初始化和删除mock chroot\"></a>初始化和删除mock chroot</h3><p>你可以先初始化mock使用的chroot，这样就可以减少构建rpm包的时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --init</span><br></pre></td></tr></table></figure>\n<p>你可以通过下面的命令来删除chroot</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --clean</span><br></pre></td></tr></table></figure>\n<h3 id=\"执行构建\"><a href=\"#执行构建\" class=\"headerlink\" title=\"执行构建\"></a>执行构建</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --rebuild xxx.src.rpm</span><br></pre></td></tr></table></figure>\n<p>当构建完成，结构和日志都在/var/lib/mock/epel-7-x86_64/result目录下。你可可以通过添加参数 –resultdir来调整目录</p>\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>通过mock可以构建不同架构不同版本下的rpm包，mock可以保证整个过程不受之前的构建的影响，并且提供了一个简单的接口用于重复构建rpm包。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>mock是一个构建rpm包的工具，你可以使用mock来编译不同系统（CentOS,RedHat和Fedora）版本的rpm包。<br>相比通过rpmbuild来构建rpm包，使用mock通过使用chroot技术，可以在一个干净的环境中来构建rpm包。</p>\n<h2 id=\"安装mock\"><a href=\"#安装mock\" class=\"headerlink\" title=\"安装mock\"></a>安装mock</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install epel-release -y</span><br><span class=\"line\"></span><br><span class=\"line\">yum install mock -y</span><br></pre></td></tr></table></figure>\n<p>需要运行mock的用户都需要添加到mock这个组里，可以通过usermod来把用户添加到mock组。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -a -G mock &lt;user&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"构建准备\"><a href=\"#构建准备\" class=\"headerlink\" title=\"构建准备\"></a>构建准备</h2><p>使用mock来构建rpm包，需要要有source rpm。<br>如果有一个spec文件，则可以通过rpmbuild来构建source rpm</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpmbuild -bs xxx.spec</span><br></pre></td></tr></table></figure>\n<p>当然，你也可以直接下载source rpm，这样就少了上面的这个步骤。</p>\n<h2 id=\"构建RPM包\"><a href=\"#构建RPM包\" class=\"headerlink\" title=\"构建RPM包\"></a>构建RPM包</h2><p>运行mock命令时，你必须要执行一个配置文件，当前系统上可用的配置文件都在/etc/mock目录下。如下面的内容：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-rw-r--r-- 1 root mock  1595 Aug 16 22:42 epel-5-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1585 Aug 16 22:42 epel-5-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1812 Aug 16 22:42 epel-6-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  1592 Aug 16 22:42 epel-6-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2250 Aug 16 22:42 epel-6-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2362 Aug 16 22:42 epel-7-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2399 Aug 16 22:42 epel-7-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2394 Aug 16 22:42 epel-7-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-25-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2014 Aug 16 22:42 fedora-25-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2022 Aug 16 22:42 fedora-25-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-25-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-25-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-26-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-26-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-26-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2015 Aug 16 22:42 fedora-26-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-26-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-27-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-27-i386.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2010 Aug 16 22:42 fedora-27-ppc64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-27-ppc64le.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2012 Aug 16 22:42 fedora-27-s390x.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2016 Aug 16 22:42 fedora-27-x86_64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2018 Aug 16 22:42 fedora-28-aarch64.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2160 Aug 16 22:42 fedora-28-armhfp.cfg</span><br><span class=\"line\">-rw-r--r-- 1 root mock  2033 Aug 16 22:42 fedora-28-i386.cfg</span><br></pre></td></tr></table></figure>\n<h3 id=\"初始化和删除mock-chroot\"><a href=\"#初始化和删除mock-chroot\" class=\"headerlink\" title=\"初始化和删除mock chroot\"></a>初始化和删除mock chroot</h3><p>你可以先初始化mock使用的chroot，这样就可以减少构建rpm包的时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --init</span><br></pre></td></tr></table></figure>\n<p>你可以通过下面的命令来删除chroot</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --clean</span><br></pre></td></tr></table></figure>\n<h3 id=\"执行构建\"><a href=\"#执行构建\" class=\"headerlink\" title=\"执行构建\"></a>执行构建</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mock -r epel-7-x86_64 --rebuild xxx.src.rpm</span><br></pre></td></tr></table></figure>\n<p>当构建完成，结构和日志都在/var/lib/mock/epel-7-x86_64/result目录下。你可可以通过添加参数 –resultdir来调整目录</p>\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>通过mock可以构建不同架构不同版本下的rpm包，mock可以保证整个过程不受之前的构建的影响，并且提供了一个简单的接口用于重复构建rpm包。</p>\n"},{"title":"s3cmd for radosgw","date":"2017-08-09T05:45:40.000Z","_content":"创建一个默认的Config文件\n```\n[root@ceph03 ~]# s3cmd --configure\n\nEnter new values or accept defaults in brackets with Enter.\nRefer to user manual for detailed description of all options.\n\nAccess key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.\nAccess Key: key\nSecret Key: secret\nDefault Region [US]:\n\nEncryption password is used to protect your files from reading\nby unauthorized persons while in transfer to S3\nEncryption password:\nPath to GPG program [/usr/bin/gpg]:\n\nWhen using secure HTTPS protocol all communication with Amazon S3\nservers is protected from 3rd party eavesdropping. This method is\nslower than plain HTTP, and can only be proxied with Python 2.7 or newer\nUse HTTPS protocol [Yes]: No\n\nOn some networks all internet access must go through a HTTP proxy.\nTry setting it here if you can't connect to S3 directly\nHTTP Proxy server name:\n\nNew settings:\n  Access Key: key\n  Secret Key: secret\n  Default Region: US\n  Encryption password:\n  Path to GPG program: /usr/bin/gpg\n  Use HTTPS protocol: False\n  HTTP Proxy server name:\n  HTTP Proxy server port: 0\n\nTest access with supplied credentials? [Y/n] n\n\nSave settings? [y/N] y\nConfiguration saved to '/root/.s3cfg'\n```\n\n修改config文件中的access_key,secret_key,host_base 和 host_bucket\n\n```\n[default]\naccess_key = O9P5CKAYAB4AHYGQPGT1\naccess_token =\nadd_encoding_exts =\nadd_headers =\nbucket_location = US\nca_certs_file =\ncache_file =\ncheck_ssl_certificate = True\ncheck_ssl_hostname = True\ncloudfront_host = cloudfront.amazonaws.com\ndefault_mime_type = binary/octet-stream\ndelay_updates = False\ndelete_after = False\ndelete_after_fetch = False\ndelete_removed = False\ndry_run = False\nenable_multipart = True\nencoding = UTF-8\nencrypt = False\nexpiry_date =\nexpiry_days =\nexpiry_prefix =\nfollow_symlinks = False\nforce = False\nget_continue = False\ngpg_command = /usr/bin/gpg\ngpg_decrypt = %(gpg_command)s -d --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s\ngpg_encrypt = %(gpg_command)s -c --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s\ngpg_passphrase =\nguess_mime_type = True\nhost_base = 172.16.143.171:8080\nhost_bucket = 172.16.143.171:8080\nhuman_readable_sizes = False\ninvalidate_default_index_on_cf = False\ninvalidate_default_index_root_on_cf = True\ninvalidate_on_cf = False\nkms_key =\nlimitrate = 0\nlist_md5 = False\nlog_target_prefix =\nlong_listing = False\nmax_delete = -1\nmime_type =\nmultipart_chunk_size_mb = 15\nmultipart_max_chunks = 10000\npreserve_attrs = True\nprogress_meter = True\nproxy_host =\nproxy_port = 0\nput_continue = False\nrecursive = False\nrecv_chunk = 65536\nreduced_redundancy = False\nrequester_pays = False\nrestore_days = 1\nsecret_key = BWyaFoWn99pN6MnaHs3NCZP6mMELMtFdJUxuONyX\nsend_chunk = 65536\nserver_side_encryption = False\nsignature_v2 = False\nsimpledb_host = sdb.amazonaws.com\nskip_existing = False\nsocket_timeout = 300\nstats = False\nstop_on_error = False\nstorage_class =\nurlencoding_mode = normal\nuse_https = False\nuse_mime_magic = True\nverbosity = WARNING\nwebsite_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com/\nwebsite_error =\nwebsite_index = index.html\n```\n\n接下来就可以通过s3cmd来进行操作了\n\n\n```\n[root@ceph02 ~]# s3cmd mb s3://test\nBucket 's3://test/' created\n[root@ceph02 ~]# s3cmd put anaconda-ks.cfg s3://test/anaconda\nupload: 'anaconda-ks.cfg' -> 's3://test/anaconda'  [1 of 1]\n 1030 of 1030   100% in    0s    57.69 kB/s  done\n[root@ceph02 ~]# s3cmd ls s3://test\n2017-08-09 06:01      1030   s3://test/anaconda\n```\n\n","source":"_posts/s3cmd.md","raw":"---\ntitle: s3cmd for radosgw\ndate: 2017-08-09 13:45:40\ntags:\n---\n创建一个默认的Config文件\n```\n[root@ceph03 ~]# s3cmd --configure\n\nEnter new values or accept defaults in brackets with Enter.\nRefer to user manual for detailed description of all options.\n\nAccess key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.\nAccess Key: key\nSecret Key: secret\nDefault Region [US]:\n\nEncryption password is used to protect your files from reading\nby unauthorized persons while in transfer to S3\nEncryption password:\nPath to GPG program [/usr/bin/gpg]:\n\nWhen using secure HTTPS protocol all communication with Amazon S3\nservers is protected from 3rd party eavesdropping. This method is\nslower than plain HTTP, and can only be proxied with Python 2.7 or newer\nUse HTTPS protocol [Yes]: No\n\nOn some networks all internet access must go through a HTTP proxy.\nTry setting it here if you can't connect to S3 directly\nHTTP Proxy server name:\n\nNew settings:\n  Access Key: key\n  Secret Key: secret\n  Default Region: US\n  Encryption password:\n  Path to GPG program: /usr/bin/gpg\n  Use HTTPS protocol: False\n  HTTP Proxy server name:\n  HTTP Proxy server port: 0\n\nTest access with supplied credentials? [Y/n] n\n\nSave settings? [y/N] y\nConfiguration saved to '/root/.s3cfg'\n```\n\n修改config文件中的access_key,secret_key,host_base 和 host_bucket\n\n```\n[default]\naccess_key = O9P5CKAYAB4AHYGQPGT1\naccess_token =\nadd_encoding_exts =\nadd_headers =\nbucket_location = US\nca_certs_file =\ncache_file =\ncheck_ssl_certificate = True\ncheck_ssl_hostname = True\ncloudfront_host = cloudfront.amazonaws.com\ndefault_mime_type = binary/octet-stream\ndelay_updates = False\ndelete_after = False\ndelete_after_fetch = False\ndelete_removed = False\ndry_run = False\nenable_multipart = True\nencoding = UTF-8\nencrypt = False\nexpiry_date =\nexpiry_days =\nexpiry_prefix =\nfollow_symlinks = False\nforce = False\nget_continue = False\ngpg_command = /usr/bin/gpg\ngpg_decrypt = %(gpg_command)s -d --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s\ngpg_encrypt = %(gpg_command)s -c --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s\ngpg_passphrase =\nguess_mime_type = True\nhost_base = 172.16.143.171:8080\nhost_bucket = 172.16.143.171:8080\nhuman_readable_sizes = False\ninvalidate_default_index_on_cf = False\ninvalidate_default_index_root_on_cf = True\ninvalidate_on_cf = False\nkms_key =\nlimitrate = 0\nlist_md5 = False\nlog_target_prefix =\nlong_listing = False\nmax_delete = -1\nmime_type =\nmultipart_chunk_size_mb = 15\nmultipart_max_chunks = 10000\npreserve_attrs = True\nprogress_meter = True\nproxy_host =\nproxy_port = 0\nput_continue = False\nrecursive = False\nrecv_chunk = 65536\nreduced_redundancy = False\nrequester_pays = False\nrestore_days = 1\nsecret_key = BWyaFoWn99pN6MnaHs3NCZP6mMELMtFdJUxuONyX\nsend_chunk = 65536\nserver_side_encryption = False\nsignature_v2 = False\nsimpledb_host = sdb.amazonaws.com\nskip_existing = False\nsocket_timeout = 300\nstats = False\nstop_on_error = False\nstorage_class =\nurlencoding_mode = normal\nuse_https = False\nuse_mime_magic = True\nverbosity = WARNING\nwebsite_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com/\nwebsite_error =\nwebsite_index = index.html\n```\n\n接下来就可以通过s3cmd来进行操作了\n\n\n```\n[root@ceph02 ~]# s3cmd mb s3://test\nBucket 's3://test/' created\n[root@ceph02 ~]# s3cmd put anaconda-ks.cfg s3://test/anaconda\nupload: 'anaconda-ks.cfg' -> 's3://test/anaconda'  [1 of 1]\n 1030 of 1030   100% in    0s    57.69 kB/s  done\n[root@ceph02 ~]# s3cmd ls s3://test\n2017-08-09 06:01      1030   s3://test/anaconda\n```\n\n","slug":"s3cmd","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2f000guhv5yjkdag51","content":"<p>创建一个默认的Config文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph03 ~]# s3cmd --configure</span><br><span class=\"line\"></span><br><span class=\"line\">Enter new values or accept defaults in brackets with Enter.</span><br><span class=\"line\">Refer to user manual for detailed description of all options.</span><br><span class=\"line\"></span><br><span class=\"line\">Access key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.</span><br><span class=\"line\">Access Key: key</span><br><span class=\"line\">Secret Key: secret</span><br><span class=\"line\">Default Region [US]:</span><br><span class=\"line\"></span><br><span class=\"line\">Encryption password is used to protect your files from reading</span><br><span class=\"line\">by unauthorized persons while in transfer to S3</span><br><span class=\"line\">Encryption password:</span><br><span class=\"line\">Path to GPG program [/usr/bin/gpg]:</span><br><span class=\"line\"></span><br><span class=\"line\">When using secure HTTPS protocol all communication with Amazon S3</span><br><span class=\"line\">servers is protected from 3rd party eavesdropping. This method is</span><br><span class=\"line\">slower than plain HTTP, and can only be proxied with Python 2.7 or newer</span><br><span class=\"line\">Use HTTPS protocol [Yes]: No</span><br><span class=\"line\"></span><br><span class=\"line\">On some networks all internet access must go through a HTTP proxy.</span><br><span class=\"line\">Try setting it here if you can&apos;t connect to S3 directly</span><br><span class=\"line\">HTTP Proxy server name:</span><br><span class=\"line\"></span><br><span class=\"line\">New settings:</span><br><span class=\"line\">  Access Key: key</span><br><span class=\"line\">  Secret Key: secret</span><br><span class=\"line\">  Default Region: US</span><br><span class=\"line\">  Encryption password:</span><br><span class=\"line\">  Path to GPG program: /usr/bin/gpg</span><br><span class=\"line\">  Use HTTPS protocol: False</span><br><span class=\"line\">  HTTP Proxy server name:</span><br><span class=\"line\">  HTTP Proxy server port: 0</span><br><span class=\"line\"></span><br><span class=\"line\">Test access with supplied credentials? [Y/n] n</span><br><span class=\"line\"></span><br><span class=\"line\">Save settings? [y/N] y</span><br><span class=\"line\">Configuration saved to &apos;/root/.s3cfg&apos;</span><br></pre></td></tr></table></figure></p>\n<p>修改config文件中的access_key,secret_key,host_base 和 host_bucket</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[default]</span><br><span class=\"line\">access_key = O9P5CKAYAB4AHYGQPGT1</span><br><span class=\"line\">access_token =</span><br><span class=\"line\">add_encoding_exts =</span><br><span class=\"line\">add_headers =</span><br><span class=\"line\">bucket_location = US</span><br><span class=\"line\">ca_certs_file =</span><br><span class=\"line\">cache_file =</span><br><span class=\"line\">check_ssl_certificate = True</span><br><span class=\"line\">check_ssl_hostname = True</span><br><span class=\"line\">cloudfront_host = cloudfront.amazonaws.com</span><br><span class=\"line\">default_mime_type = binary/octet-stream</span><br><span class=\"line\">delay_updates = False</span><br><span class=\"line\">delete_after = False</span><br><span class=\"line\">delete_after_fetch = False</span><br><span class=\"line\">delete_removed = False</span><br><span class=\"line\">dry_run = False</span><br><span class=\"line\">enable_multipart = True</span><br><span class=\"line\">encoding = UTF-8</span><br><span class=\"line\">encrypt = False</span><br><span class=\"line\">expiry_date =</span><br><span class=\"line\">expiry_days =</span><br><span class=\"line\">expiry_prefix =</span><br><span class=\"line\">follow_symlinks = False</span><br><span class=\"line\">force = False</span><br><span class=\"line\">get_continue = False</span><br><span class=\"line\">gpg_command = /usr/bin/gpg</span><br><span class=\"line\">gpg_decrypt = %(gpg_command)s -d --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s</span><br><span class=\"line\">gpg_encrypt = %(gpg_command)s -c --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s</span><br><span class=\"line\">gpg_passphrase =</span><br><span class=\"line\">guess_mime_type = True</span><br><span class=\"line\">host_base = 172.16.143.171:8080</span><br><span class=\"line\">host_bucket = 172.16.143.171:8080</span><br><span class=\"line\">human_readable_sizes = False</span><br><span class=\"line\">invalidate_default_index_on_cf = False</span><br><span class=\"line\">invalidate_default_index_root_on_cf = True</span><br><span class=\"line\">invalidate_on_cf = False</span><br><span class=\"line\">kms_key =</span><br><span class=\"line\">limitrate = 0</span><br><span class=\"line\">list_md5 = False</span><br><span class=\"line\">log_target_prefix =</span><br><span class=\"line\">long_listing = False</span><br><span class=\"line\">max_delete = -1</span><br><span class=\"line\">mime_type =</span><br><span class=\"line\">multipart_chunk_size_mb = 15</span><br><span class=\"line\">multipart_max_chunks = 10000</span><br><span class=\"line\">preserve_attrs = True</span><br><span class=\"line\">progress_meter = True</span><br><span class=\"line\">proxy_host =</span><br><span class=\"line\">proxy_port = 0</span><br><span class=\"line\">put_continue = False</span><br><span class=\"line\">recursive = False</span><br><span class=\"line\">recv_chunk = 65536</span><br><span class=\"line\">reduced_redundancy = False</span><br><span class=\"line\">requester_pays = False</span><br><span class=\"line\">restore_days = 1</span><br><span class=\"line\">secret_key = BWyaFoWn99pN6MnaHs3NCZP6mMELMtFdJUxuONyX</span><br><span class=\"line\">send_chunk = 65536</span><br><span class=\"line\">server_side_encryption = False</span><br><span class=\"line\">signature_v2 = False</span><br><span class=\"line\">simpledb_host = sdb.amazonaws.com</span><br><span class=\"line\">skip_existing = False</span><br><span class=\"line\">socket_timeout = 300</span><br><span class=\"line\">stats = False</span><br><span class=\"line\">stop_on_error = False</span><br><span class=\"line\">storage_class =</span><br><span class=\"line\">urlencoding_mode = normal</span><br><span class=\"line\">use_https = False</span><br><span class=\"line\">use_mime_magic = True</span><br><span class=\"line\">verbosity = WARNING</span><br><span class=\"line\">website_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com/</span><br><span class=\"line\">website_error =</span><br><span class=\"line\">website_index = index.html</span><br></pre></td></tr></table></figure>\n<p>接下来就可以通过s3cmd来进行操作了</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph02 ~]# s3cmd mb s3://test</span><br><span class=\"line\">Bucket &apos;s3://test/&apos; created</span><br><span class=\"line\">[root@ceph02 ~]# s3cmd put anaconda-ks.cfg s3://test/anaconda</span><br><span class=\"line\">upload: &apos;anaconda-ks.cfg&apos; -&gt; &apos;s3://test/anaconda&apos;  [1 of 1]</span><br><span class=\"line\"> 1030 of 1030   100% in    0s    57.69 kB/s  done</span><br><span class=\"line\">[root@ceph02 ~]# s3cmd ls s3://test</span><br><span class=\"line\">2017-08-09 06:01      1030   s3://test/anaconda</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>创建一个默认的Config文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph03 ~]# s3cmd --configure</span><br><span class=\"line\"></span><br><span class=\"line\">Enter new values or accept defaults in brackets with Enter.</span><br><span class=\"line\">Refer to user manual for detailed description of all options.</span><br><span class=\"line\"></span><br><span class=\"line\">Access key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.</span><br><span class=\"line\">Access Key: key</span><br><span class=\"line\">Secret Key: secret</span><br><span class=\"line\">Default Region [US]:</span><br><span class=\"line\"></span><br><span class=\"line\">Encryption password is used to protect your files from reading</span><br><span class=\"line\">by unauthorized persons while in transfer to S3</span><br><span class=\"line\">Encryption password:</span><br><span class=\"line\">Path to GPG program [/usr/bin/gpg]:</span><br><span class=\"line\"></span><br><span class=\"line\">When using secure HTTPS protocol all communication with Amazon S3</span><br><span class=\"line\">servers is protected from 3rd party eavesdropping. This method is</span><br><span class=\"line\">slower than plain HTTP, and can only be proxied with Python 2.7 or newer</span><br><span class=\"line\">Use HTTPS protocol [Yes]: No</span><br><span class=\"line\"></span><br><span class=\"line\">On some networks all internet access must go through a HTTP proxy.</span><br><span class=\"line\">Try setting it here if you can&apos;t connect to S3 directly</span><br><span class=\"line\">HTTP Proxy server name:</span><br><span class=\"line\"></span><br><span class=\"line\">New settings:</span><br><span class=\"line\">  Access Key: key</span><br><span class=\"line\">  Secret Key: secret</span><br><span class=\"line\">  Default Region: US</span><br><span class=\"line\">  Encryption password:</span><br><span class=\"line\">  Path to GPG program: /usr/bin/gpg</span><br><span class=\"line\">  Use HTTPS protocol: False</span><br><span class=\"line\">  HTTP Proxy server name:</span><br><span class=\"line\">  HTTP Proxy server port: 0</span><br><span class=\"line\"></span><br><span class=\"line\">Test access with supplied credentials? [Y/n] n</span><br><span class=\"line\"></span><br><span class=\"line\">Save settings? [y/N] y</span><br><span class=\"line\">Configuration saved to &apos;/root/.s3cfg&apos;</span><br></pre></td></tr></table></figure></p>\n<p>修改config文件中的access_key,secret_key,host_base 和 host_bucket</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[default]</span><br><span class=\"line\">access_key = O9P5CKAYAB4AHYGQPGT1</span><br><span class=\"line\">access_token =</span><br><span class=\"line\">add_encoding_exts =</span><br><span class=\"line\">add_headers =</span><br><span class=\"line\">bucket_location = US</span><br><span class=\"line\">ca_certs_file =</span><br><span class=\"line\">cache_file =</span><br><span class=\"line\">check_ssl_certificate = True</span><br><span class=\"line\">check_ssl_hostname = True</span><br><span class=\"line\">cloudfront_host = cloudfront.amazonaws.com</span><br><span class=\"line\">default_mime_type = binary/octet-stream</span><br><span class=\"line\">delay_updates = False</span><br><span class=\"line\">delete_after = False</span><br><span class=\"line\">delete_after_fetch = False</span><br><span class=\"line\">delete_removed = False</span><br><span class=\"line\">dry_run = False</span><br><span class=\"line\">enable_multipart = True</span><br><span class=\"line\">encoding = UTF-8</span><br><span class=\"line\">encrypt = False</span><br><span class=\"line\">expiry_date =</span><br><span class=\"line\">expiry_days =</span><br><span class=\"line\">expiry_prefix =</span><br><span class=\"line\">follow_symlinks = False</span><br><span class=\"line\">force = False</span><br><span class=\"line\">get_continue = False</span><br><span class=\"line\">gpg_command = /usr/bin/gpg</span><br><span class=\"line\">gpg_decrypt = %(gpg_command)s -d --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s</span><br><span class=\"line\">gpg_encrypt = %(gpg_command)s -c --verbose --no-use-agent --batch --yes --passphrase-fd %(passphrase_fd)s -o %(output_file)s %(input_file)s</span><br><span class=\"line\">gpg_passphrase =</span><br><span class=\"line\">guess_mime_type = True</span><br><span class=\"line\">host_base = 172.16.143.171:8080</span><br><span class=\"line\">host_bucket = 172.16.143.171:8080</span><br><span class=\"line\">human_readable_sizes = False</span><br><span class=\"line\">invalidate_default_index_on_cf = False</span><br><span class=\"line\">invalidate_default_index_root_on_cf = True</span><br><span class=\"line\">invalidate_on_cf = False</span><br><span class=\"line\">kms_key =</span><br><span class=\"line\">limitrate = 0</span><br><span class=\"line\">list_md5 = False</span><br><span class=\"line\">log_target_prefix =</span><br><span class=\"line\">long_listing = False</span><br><span class=\"line\">max_delete = -1</span><br><span class=\"line\">mime_type =</span><br><span class=\"line\">multipart_chunk_size_mb = 15</span><br><span class=\"line\">multipart_max_chunks = 10000</span><br><span class=\"line\">preserve_attrs = True</span><br><span class=\"line\">progress_meter = True</span><br><span class=\"line\">proxy_host =</span><br><span class=\"line\">proxy_port = 0</span><br><span class=\"line\">put_continue = False</span><br><span class=\"line\">recursive = False</span><br><span class=\"line\">recv_chunk = 65536</span><br><span class=\"line\">reduced_redundancy = False</span><br><span class=\"line\">requester_pays = False</span><br><span class=\"line\">restore_days = 1</span><br><span class=\"line\">secret_key = BWyaFoWn99pN6MnaHs3NCZP6mMELMtFdJUxuONyX</span><br><span class=\"line\">send_chunk = 65536</span><br><span class=\"line\">server_side_encryption = False</span><br><span class=\"line\">signature_v2 = False</span><br><span class=\"line\">simpledb_host = sdb.amazonaws.com</span><br><span class=\"line\">skip_existing = False</span><br><span class=\"line\">socket_timeout = 300</span><br><span class=\"line\">stats = False</span><br><span class=\"line\">stop_on_error = False</span><br><span class=\"line\">storage_class =</span><br><span class=\"line\">urlencoding_mode = normal</span><br><span class=\"line\">use_https = False</span><br><span class=\"line\">use_mime_magic = True</span><br><span class=\"line\">verbosity = WARNING</span><br><span class=\"line\">website_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com/</span><br><span class=\"line\">website_error =</span><br><span class=\"line\">website_index = index.html</span><br></pre></td></tr></table></figure>\n<p>接下来就可以通过s3cmd来进行操作了</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@ceph02 ~]# s3cmd mb s3://test</span><br><span class=\"line\">Bucket &apos;s3://test/&apos; created</span><br><span class=\"line\">[root@ceph02 ~]# s3cmd put anaconda-ks.cfg s3://test/anaconda</span><br><span class=\"line\">upload: &apos;anaconda-ks.cfg&apos; -&gt; &apos;s3://test/anaconda&apos;  [1 of 1]</span><br><span class=\"line\"> 1030 of 1030   100% in    0s    57.69 kB/s  done</span><br><span class=\"line\">[root@ceph02 ~]# s3cmd ls s3://test</span><br><span class=\"line\">2017-08-09 06:01      1030   s3://test/anaconda</span><br></pre></td></tr></table></figure>\n"},{"title":"service start too often","date":"2017-12-18T08:15:08.000Z","_content":"\n通过systemd来管理服务，经常会遇到这种错误\"failed because start of the service wasattempted too often\".\n\n遇到这种情况可以到/etc/systemd/system目录下，修改相应的service文件\n\n一般情况下在添加下面的内容即可：\n\n`[Service]\nStartLimitBurst=0`\n\n保存退出后，执行reload\n\n`\nsudo systemctl daemon-reload\n`\n\n再启动相应服务即可。\n","source":"_posts/service-too-quickly.md","raw":"---\ntitle: service start too often\ndate: 2017-12-18 16:15:08\ntags:\n---\n\n通过systemd来管理服务，经常会遇到这种错误\"failed because start of the service wasattempted too often\".\n\n遇到这种情况可以到/etc/systemd/system目录下，修改相应的service文件\n\n一般情况下在添加下面的内容即可：\n\n`[Service]\nStartLimitBurst=0`\n\n保存退出后，执行reload\n\n`\nsudo systemctl daemon-reload\n`\n\n再启动相应服务即可。\n","slug":"service-too-quickly","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2g000juhv5mz2iszlp","content":"<p>通过systemd来管理服务，经常会遇到这种错误”failed because start of the service wasattempted too often”.</p>\n<p>遇到这种情况可以到/etc/systemd/system目录下，修改相应的service文件</p>\n<p>一般情况下在添加下面的内容即可：</p>\n<p><code>[Service]\nStartLimitBurst=0</code></p>\n<p>保存退出后，执行reload</p>\n<p><code>sudo systemctl daemon-reload</code></p>\n<p>再启动相应服务即可。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>通过systemd来管理服务，经常会遇到这种错误”failed because start of the service wasattempted too often”.</p>\n<p>遇到这种情况可以到/etc/systemd/system目录下，修改相应的service文件</p>\n<p>一般情况下在添加下面的内容即可：</p>\n<p><code>[Service]\nStartLimitBurst=0</code></p>\n<p>保存退出后，执行reload</p>\n<p><code>sudo systemctl daemon-reload</code></p>\n<p>再启动相应服务即可。</p>\n"},{"title":"String Join","date":"2017-07-07T10:01:39.000Z","_content":"### 简单字符串\n直接使用\"+\"，\n例如：\n```\nfull_name = prefix + name\n```\n### 复杂字符串\n有格式化需求时，使用\"%\"进行格式化连接，\n例如：\n```\nresult = \"result is %s:%d\" % (name, score)\n```\n\n### 大量字符串拼接\n发生在循环体里时，使用\"str.join\"进行连接，\n例如：\n```\nresult = ''.join(names_tuple)\n```\n\n## 总结\n前两条出于代码美观考虑，后一条出于性能考虑\n","source":"_posts/string-join.md","raw":"---\ntitle: String Join\ndate: 2017-07-07 18:01:39\ntags: python\n---\n### 简单字符串\n直接使用\"+\"，\n例如：\n```\nfull_name = prefix + name\n```\n### 复杂字符串\n有格式化需求时，使用\"%\"进行格式化连接，\n例如：\n```\nresult = \"result is %s:%d\" % (name, score)\n```\n\n### 大量字符串拼接\n发生在循环体里时，使用\"str.join\"进行连接，\n例如：\n```\nresult = ''.join(names_tuple)\n```\n\n## 总结\n前两条出于代码美观考虑，后一条出于性能考虑\n","slug":"string-join","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2h000kuhv5iaofi0q9","content":"<h3 id=\"简单字符串\"><a href=\"#简单字符串\" class=\"headerlink\" title=\"简单字符串\"></a>简单字符串</h3><p>直接使用”+”，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">full_name = prefix + name</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"复杂字符串\"><a href=\"#复杂字符串\" class=\"headerlink\" title=\"复杂字符串\"></a>复杂字符串</h3><p>有格式化需求时，使用”%”进行格式化连接，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = &quot;result is %s:%d&quot; % (name, score)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"大量字符串拼接\"><a href=\"#大量字符串拼接\" class=\"headerlink\" title=\"大量字符串拼接\"></a>大量字符串拼接</h3><p>发生在循环体里时，使用”str.join”进行连接，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = &apos;&apos;.join(names_tuple)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>前两条出于代码美观考虑，后一条出于性能考虑</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"简单字符串\"><a href=\"#简单字符串\" class=\"headerlink\" title=\"简单字符串\"></a>简单字符串</h3><p>直接使用”+”，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">full_name = prefix + name</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"复杂字符串\"><a href=\"#复杂字符串\" class=\"headerlink\" title=\"复杂字符串\"></a>复杂字符串</h3><p>有格式化需求时，使用”%”进行格式化连接，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = &quot;result is %s:%d&quot; % (name, score)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"大量字符串拼接\"><a href=\"#大量字符串拼接\" class=\"headerlink\" title=\"大量字符串拼接\"></a>大量字符串拼接</h3><p>发生在循环体里时，使用”str.join”进行连接，<br>例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = &apos;&apos;.join(names_tuple)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>前两条出于代码美观考虑，后一条出于性能考虑</p>\n"},{"title":"timedatectl","date":"2017-09-12T10:00:19.000Z","_content":"CentOS 7 设置日期和时间\n\n在CentOS 6版本，时间设置有date、hwclock命令，从CentOS 7开始，使用了一个新的命令timedatectl。\n\n一、基本概念\n\n1.1 GMT、UTC、CST、DST 时间\n\n(1) UTC\n\n整个地球分为二十四时区，每个时区都有自己的本地时间。在国际无线电通信场合，为了统一起见，使用一个统一的时间，称为通用协调时(UTC, Universal Time Coordinated)。\n\n(2) GMT\n\n格林威治标准时间 (Greenwich Mean Time)指位于英国伦敦郊区的皇家格林尼治天文台的标准时间，因为本初子午线被定义在通过那里的经线。(UTC与GMT时间基本相同，本文中不做区分)\n\n(3) CST\n\n中国标准时间 (China Standard Time)\n\n1\nGMT + 8 = UTC + 8 = CST\n(4) DST\n\n夏令时(Daylight Saving Time) 指在夏天太阳升起的比较早时，将时钟拨快一小时，以提早日光的使用。（中国不使用）\n\n1.2 硬件时钟和系统时钟\n\n(1) 硬件时钟\n\nRTC(Real-Time Clock)或CMOS时钟，一般在主板上靠电池供电，服务器断电后也会继续运行。仅保存日期时间数值，无法保存时区和夏令时设置。\n\n(2) 系统时钟\n\n一般在服务器启动时复制RTC时间，之后独立运行，保存了时间、时区和夏令时设置。\n\n二、timedatectl 命令\n\n2.1 读取时间\n\n```\ntimedatectl //等同于 timedatectl status\n```\n2.2 设置时间\n\n```\ntimedatectl set-time \"YYYY-MM-DD HH:MM:SS\"\n```\n\n2.3 列出所有时区\n\n```\ntimedatectl list-timezones\n```\n\n2.4 设置时区\n\n```\ntimedatectl set-timezone Asia/Shanghai\n```\n\n2.5 是否NTP服务器同步\n\n```\ntimedatectl set-ntp yes //yes或者no\n```\n\n2.6 将硬件时钟调整为与本地时钟一致\n\n```\ntimedatectl set-local-rtc 1\nhwclock --systohc --localtime //与上面命令效果一致\n```\n注意 硬件时钟默认使用UTC时间，因为硬件时钟不能保存时区和夏令时调整，修改后就无法从硬件时钟中读取出准确标准时间，因此不建议修改。修改后系统会出现警告。\n\n2.6 硬件时间设置成 UTC：\n\n```\ntimedatectl set-local-rtc 1\nhwclock --systohc --utc //与上面命令效果一致\n```\n\n三、设置系统时间为中国时区并启用NTP同步\n\n```\nyum install ntp //安装ntp服务\nsystemctl enable ntpd //开机启动服务\nsystemctl start ntpd //启动服务\ntimedatectl set-timezone Asia/Shanghai //更改时区\ntimedatectl set-ntp yes //启用ntp同步\nntpq -p //同步时间\n```\n如需更改时间服务器, 修改 /etc/ntp.conf 文件中的服务器地址 server 即可.","source":"_posts/timedatectl.md","raw":"---\ntitle: timedatectl\ndate: 2017-09-12 18:00:19\ntags:\n---\nCentOS 7 设置日期和时间\n\n在CentOS 6版本，时间设置有date、hwclock命令，从CentOS 7开始，使用了一个新的命令timedatectl。\n\n一、基本概念\n\n1.1 GMT、UTC、CST、DST 时间\n\n(1) UTC\n\n整个地球分为二十四时区，每个时区都有自己的本地时间。在国际无线电通信场合，为了统一起见，使用一个统一的时间，称为通用协调时(UTC, Universal Time Coordinated)。\n\n(2) GMT\n\n格林威治标准时间 (Greenwich Mean Time)指位于英国伦敦郊区的皇家格林尼治天文台的标准时间，因为本初子午线被定义在通过那里的经线。(UTC与GMT时间基本相同，本文中不做区分)\n\n(3) CST\n\n中国标准时间 (China Standard Time)\n\n1\nGMT + 8 = UTC + 8 = CST\n(4) DST\n\n夏令时(Daylight Saving Time) 指在夏天太阳升起的比较早时，将时钟拨快一小时，以提早日光的使用。（中国不使用）\n\n1.2 硬件时钟和系统时钟\n\n(1) 硬件时钟\n\nRTC(Real-Time Clock)或CMOS时钟，一般在主板上靠电池供电，服务器断电后也会继续运行。仅保存日期时间数值，无法保存时区和夏令时设置。\n\n(2) 系统时钟\n\n一般在服务器启动时复制RTC时间，之后独立运行，保存了时间、时区和夏令时设置。\n\n二、timedatectl 命令\n\n2.1 读取时间\n\n```\ntimedatectl //等同于 timedatectl status\n```\n2.2 设置时间\n\n```\ntimedatectl set-time \"YYYY-MM-DD HH:MM:SS\"\n```\n\n2.3 列出所有时区\n\n```\ntimedatectl list-timezones\n```\n\n2.4 设置时区\n\n```\ntimedatectl set-timezone Asia/Shanghai\n```\n\n2.5 是否NTP服务器同步\n\n```\ntimedatectl set-ntp yes //yes或者no\n```\n\n2.6 将硬件时钟调整为与本地时钟一致\n\n```\ntimedatectl set-local-rtc 1\nhwclock --systohc --localtime //与上面命令效果一致\n```\n注意 硬件时钟默认使用UTC时间，因为硬件时钟不能保存时区和夏令时调整，修改后就无法从硬件时钟中读取出准确标准时间，因此不建议修改。修改后系统会出现警告。\n\n2.6 硬件时间设置成 UTC：\n\n```\ntimedatectl set-local-rtc 1\nhwclock --systohc --utc //与上面命令效果一致\n```\n\n三、设置系统时间为中国时区并启用NTP同步\n\n```\nyum install ntp //安装ntp服务\nsystemctl enable ntpd //开机启动服务\nsystemctl start ntpd //启动服务\ntimedatectl set-timezone Asia/Shanghai //更改时区\ntimedatectl set-ntp yes //启用ntp同步\nntpq -p //同步时间\n```\n如需更改时间服务器, 修改 /etc/ntp.conf 文件中的服务器地址 server 即可.","slug":"timedatectl","published":1,"updated":"2018-03-07T05:39:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjmkr9i2i000muhv5d8gvyd5r","content":"<p>CentOS 7 设置日期和时间</p>\n<p>在CentOS 6版本，时间设置有date、hwclock命令，从CentOS 7开始，使用了一个新的命令timedatectl。</p>\n<p>一、基本概念</p>\n<p>1.1 GMT、UTC、CST、DST 时间</p>\n<p>(1) UTC</p>\n<p>整个地球分为二十四时区，每个时区都有自己的本地时间。在国际无线电通信场合，为了统一起见，使用一个统一的时间，称为通用协调时(UTC, Universal Time Coordinated)。</p>\n<p>(2) GMT</p>\n<p>格林威治标准时间 (Greenwich Mean Time)指位于英国伦敦郊区的皇家格林尼治天文台的标准时间，因为本初子午线被定义在通过那里的经线。(UTC与GMT时间基本相同，本文中不做区分)</p>\n<p>(3) CST</p>\n<p>中国标准时间 (China Standard Time)</p>\n<p>1<br>GMT + 8 = UTC + 8 = CST<br>(4) DST</p>\n<p>夏令时(Daylight Saving Time) 指在夏天太阳升起的比较早时，将时钟拨快一小时，以提早日光的使用。（中国不使用）</p>\n<p>1.2 硬件时钟和系统时钟</p>\n<p>(1) 硬件时钟</p>\n<p>RTC(Real-Time Clock)或CMOS时钟，一般在主板上靠电池供电，服务器断电后也会继续运行。仅保存日期时间数值，无法保存时区和夏令时设置。</p>\n<p>(2) 系统时钟</p>\n<p>一般在服务器启动时复制RTC时间，之后独立运行，保存了时间、时区和夏令时设置。</p>\n<p>二、timedatectl 命令</p>\n<p>2.1 读取时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl //等同于 timedatectl status</span><br></pre></td></tr></table></figure>\n<p>2.2 设置时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-time &quot;YYYY-MM-DD HH:MM:SS&quot;</span><br></pre></td></tr></table></figure>\n<p>2.3 列出所有时区</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl list-timezones</span><br></pre></td></tr></table></figure>\n<p>2.4 设置时区</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>\n<p>2.5 是否NTP服务器同步</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-ntp yes //yes或者no</span><br></pre></td></tr></table></figure>\n<p>2.6 将硬件时钟调整为与本地时钟一致</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-local-rtc 1</span><br><span class=\"line\">hwclock --systohc --localtime //与上面命令效果一致</span><br></pre></td></tr></table></figure>\n<p>注意 硬件时钟默认使用UTC时间，因为硬件时钟不能保存时区和夏令时调整，修改后就无法从硬件时钟中读取出准确标准时间，因此不建议修改。修改后系统会出现警告。</p>\n<p>2.6 硬件时间设置成 UTC：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-local-rtc 1</span><br><span class=\"line\">hwclock --systohc --utc //与上面命令效果一致</span><br></pre></td></tr></table></figure>\n<p>三、设置系统时间为中国时区并启用NTP同步</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install ntp //安装ntp服务</span><br><span class=\"line\">systemctl enable ntpd //开机启动服务</span><br><span class=\"line\">systemctl start ntpd //启动服务</span><br><span class=\"line\">timedatectl set-timezone Asia/Shanghai //更改时区</span><br><span class=\"line\">timedatectl set-ntp yes //启用ntp同步</span><br><span class=\"line\">ntpq -p //同步时间</span><br></pre></td></tr></table></figure>\n<p>如需更改时间服务器, 修改 /etc/ntp.conf 文件中的服务器地址 server 即可.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>CentOS 7 设置日期和时间</p>\n<p>在CentOS 6版本，时间设置有date、hwclock命令，从CentOS 7开始，使用了一个新的命令timedatectl。</p>\n<p>一、基本概念</p>\n<p>1.1 GMT、UTC、CST、DST 时间</p>\n<p>(1) UTC</p>\n<p>整个地球分为二十四时区，每个时区都有自己的本地时间。在国际无线电通信场合，为了统一起见，使用一个统一的时间，称为通用协调时(UTC, Universal Time Coordinated)。</p>\n<p>(2) GMT</p>\n<p>格林威治标准时间 (Greenwich Mean Time)指位于英国伦敦郊区的皇家格林尼治天文台的标准时间，因为本初子午线被定义在通过那里的经线。(UTC与GMT时间基本相同，本文中不做区分)</p>\n<p>(3) CST</p>\n<p>中国标准时间 (China Standard Time)</p>\n<p>1<br>GMT + 8 = UTC + 8 = CST<br>(4) DST</p>\n<p>夏令时(Daylight Saving Time) 指在夏天太阳升起的比较早时，将时钟拨快一小时，以提早日光的使用。（中国不使用）</p>\n<p>1.2 硬件时钟和系统时钟</p>\n<p>(1) 硬件时钟</p>\n<p>RTC(Real-Time Clock)或CMOS时钟，一般在主板上靠电池供电，服务器断电后也会继续运行。仅保存日期时间数值，无法保存时区和夏令时设置。</p>\n<p>(2) 系统时钟</p>\n<p>一般在服务器启动时复制RTC时间，之后独立运行，保存了时间、时区和夏令时设置。</p>\n<p>二、timedatectl 命令</p>\n<p>2.1 读取时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl //等同于 timedatectl status</span><br></pre></td></tr></table></figure>\n<p>2.2 设置时间</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-time &quot;YYYY-MM-DD HH:MM:SS&quot;</span><br></pre></td></tr></table></figure>\n<p>2.3 列出所有时区</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl list-timezones</span><br></pre></td></tr></table></figure>\n<p>2.4 设置时区</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>\n<p>2.5 是否NTP服务器同步</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-ntp yes //yes或者no</span><br></pre></td></tr></table></figure>\n<p>2.6 将硬件时钟调整为与本地时钟一致</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-local-rtc 1</span><br><span class=\"line\">hwclock --systohc --localtime //与上面命令效果一致</span><br></pre></td></tr></table></figure>\n<p>注意 硬件时钟默认使用UTC时间，因为硬件时钟不能保存时区和夏令时调整，修改后就无法从硬件时钟中读取出准确标准时间，因此不建议修改。修改后系统会出现警告。</p>\n<p>2.6 硬件时间设置成 UTC：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">timedatectl set-local-rtc 1</span><br><span class=\"line\">hwclock --systohc --utc //与上面命令效果一致</span><br></pre></td></tr></table></figure>\n<p>三、设置系统时间为中国时区并启用NTP同步</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install ntp //安装ntp服务</span><br><span class=\"line\">systemctl enable ntpd //开机启动服务</span><br><span class=\"line\">systemctl start ntpd //启动服务</span><br><span class=\"line\">timedatectl set-timezone Asia/Shanghai //更改时区</span><br><span class=\"line\">timedatectl set-ntp yes //启用ntp同步</span><br><span class=\"line\">ntpq -p //同步时间</span><br></pre></td></tr></table></figure>\n<p>如需更改时间服务器, 修改 /etc/ntp.conf 文件中的服务器地址 server 即可.</p>\n"}],"PostAsset":[{"_id":"source/_posts/nextcloud-ceph/nextcloud1.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud1.png","modified":1,"renderable":1},{"_id":"source/_posts/nextcloud-ceph/nextcloud2.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud2.png","modified":1,"renderable":1},{"_id":"source/_posts/nextcloud-ceph/nextcloud3.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud3.png","modified":1,"renderable":1},{"_id":"source/_posts/nextcloud-ceph/nextcloud4.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud4.png","modified":1,"renderable":1},{"_id":"source/_posts/nextcloud-ceph/nextcloud5.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud5.png","modified":1,"renderable":1},{"_id":"source/_posts/nextcloud-ceph/nextcloud6.png","post":"cjmkr9i260007uhv5kyjdoeun","slug":"nextcloud6.png","modified":1,"renderable":1}],"PostCategory":[],"PostTag":[{"post_id":"cjmkr9i200003uhv585atfqxo","tag_id":"cjmkr9i220005uhv5kx5bt5i2","_id":"cjmkr9i29000auhv5gs0cx84x"},{"post_id":"cjmkr9i2c000cuhv5en24thfy","tag_id":"cjmkr9i280009uhv5mflbd203","_id":"cjmkr9i2e000fuhv52432h0jw"},{"post_id":"cjmkr9i2d000euhv5awqty0xk","tag_id":"cjmkr9i280009uhv5mflbd203","_id":"cjmkr9i2g000iuhv5cop8rba7"},{"post_id":"cjmkr9i240006uhv5esdpxn1b","tag_id":"cjmkr9i280009uhv5mflbd203","_id":"cjmkr9i2k000nuhv52nj5kjpu"},{"post_id":"cjmkr9i240006uhv5esdpxn1b","tag_id":"cjmkr9i2d000duhv5uyhfu531","_id":"cjmkr9i2k000ouhv5i6nw59mm"},{"post_id":"cjmkr9i240006uhv5esdpxn1b","tag_id":"cjmkr9i2f000huhv54r9kjtge","_id":"cjmkr9i2l000quhv5tad0uwq9"},{"post_id":"cjmkr9i270008uhv550z0d8w6","tag_id":"cjmkr9i280009uhv5mflbd203","_id":"cjmkr9i2n000tuhv5sy9nfumi"},{"post_id":"cjmkr9i270008uhv550z0d8w6","tag_id":"cjmkr9i2d000duhv5uyhfu531","_id":"cjmkr9i2n000uuhv5t1adh1dx"},{"post_id":"cjmkr9i270008uhv550z0d8w6","tag_id":"cjmkr9i2f000huhv54r9kjtge","_id":"cjmkr9i2o000wuhv5vz4tto5m"},{"post_id":"cjmkr9i2a000buhv5v8muxmxv","tag_id":"cjmkr9i2n000suhv5fljdsw8h","_id":"cjmkr9i2o000xuhv5vd4upq50"},{"post_id":"cjmkr9i2h000kuhv5iaofi0q9","tag_id":"cjmkr9i2n000vuhv5bf9t25ab","_id":"cjmkr9i2o000yuhv5iyshs1gk"}],"Tag":[{"name":"git","_id":"cjmkr9i220005uhv5kx5bt5i2"},{"name":"linux","_id":"cjmkr9i280009uhv5mflbd203"},{"name":"mysql","_id":"cjmkr9i2d000duhv5uyhfu531"},{"name":"ha","_id":"cjmkr9i2f000huhv54r9kjtge"},{"name":"redis","_id":"cjmkr9i2n000suhv5fljdsw8h"},{"name":"python","_id":"cjmkr9i2n000vuhv5bf9t25ab"}]}}